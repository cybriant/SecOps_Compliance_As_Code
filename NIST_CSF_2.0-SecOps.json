[{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-01","Subcategory Description":" Inventories of hardware managed by the organization are maintained","Implementation Examples":"Ex1","Example Description":" Maintain inventories for all types of hardware, including IT, IoT, OT, and mobile devices","Informative References":"CCMv4.0: CCC-04\nCCMv4.0: DCS-06\nCCMv4.0: DSP-19\nCCMv4.0: UEM-04\nCIS Controls v8.0: 1.1\nCRI Profile v2.0: ID.AM-01\nCRI Profile v2.0: ID.AM-01.01\nCSF v1.1: ID.AM-1\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: CM-08\nSP 800-53 Rev 5.1.1: PM-05","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"This search will pull all hostnames SecOps has seen from all hostname fields and log source types.","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$hostname = group($e.principal.hostname,$e.target.hostname,$e.src.hostname,$e.intermediary.hostname,$e.observer.hostname,$e.principal.asset.hostname,$e.src.asset.hostname,$e.target.asset.hostname)\n$hostname = \/.*\/\nmatch:\n    $hostname\noutcome:\n\t$logsSeen = array_distinct($e.metadata.log_type)\norder:\n\t$hostname","API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-01","Subcategory Description":" Inventories of hardware managed by the organization are maintained","Implementation Examples":"Ex2","Example Description":" Constantly monitor networks to detect new hardware and automatically update inventories","Informative References":"CCMv4.0: CCC-04\nCCMv4.0: DCS-06\nCCMv4.0: DSP-19\nCCMv4.0: UEM-04\nCIS Controls v8.0: 1.1\nCRI Profile v2.0: ID.AM-01\nCRI Profile v2.0: ID.AM-01.01\nCSF v1.1: ID.AM-1\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: CM-08\nSP 800-53 Rev 5.1.1: PM-05","Exportable From SIEM":"Yes","API":"Dashboard Export API","Difficulty":"Done","Comments":"In Google SecOps some parsers append specific metadata to declare the type of entity that was involved in the event.  The UDM for it is \"metadata.entity_type\".  However, as of Q3 2024 UDM Search will not search with the metadata.entity_type keyword.  However, it is possible to retrieve this data via the Dashboarding functionality in SecOps.  To retrieve this data, a dashboard must first be created.  Afterwards, the dashboard may be exported via API.  UDM fields expected to use are the following:   principal.asset.hostname, metadata.log_type, and some sort of first seen date that will populate without showing 1970-01-01.\n\nDashboard Name:  R2 ID.AM-01 Ex2 - Detect New Hardware","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":"R2 ID.AM-01 Ex2 - Detect New Hardware","Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-02","Subcategory Description":" Inventories of software, services, and systems managed by the organization are maintained","Implementation Examples":"Ex1","Example Description":" Maintain inventories for all types of software and services, including commercial-off-the-shelf, open-source, custom applications, API services, and cloud-based applications and services","Informative References":"CCMv4.0: CCC-04\nCCMv4.0: DCS-06\nCCMv4.0: DSP-19\nCCMv4.0: UEM-02\nCCMv4.0: UEM-04\nCIS Controls v8.0: 2.1\nCRI Profile v2.0: ID.AM-02\nCRI Profile v2.0: ID.AM-02.01\nCSF v1.1: ID.AM-2\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: AC-20\nSP 800-53 Rev 5.1.1: CM-08\nSP 800-53 Rev 5.1.1: PM-05\nSP 800-53 Rev 5.1.1: SA-05\nSP 800-53 Rev 5.1.1: SA-09","Exportable From SIEM":"Partial","API":"UDM Search with YL2","Difficulty":"Unverified","Comments":"All log data sources can be pulled for applications, hosts, and cloud technologies sending logs.  Software names should be able to be ingested if there is a parser as the field about.asset.software.name exists.\n\nNote:  The following query is syntatically correct, but there was no data source that correctly parses to the about.asset.software.name UDM field.","Linked Query":false,"Vendor":"Agnostic","Query Version":"Alpha","Dashboard Name":null,"Pretty Print Queries":"$software = $e.about.asset.software.name\n$software = \/.*\/\n\nmatch:\n    $software\n\noutcome:\n    $softwareVendor = array_distinct($e.about.asset.software.vendor_name)\n    $softwareVersion = array_distinct($e.about.asset.software.version)\n    $softwareDescription = array_distinct($e.about.asset.software.description)\n\norder:\n    $software","API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-02","Subcategory Description":" Inventories of software, services, and systems managed by the organization are maintained","Implementation Examples":"Ex2","Example Description":" Constantly monitor all platforms, including containers and virtual machines, for software and service inventory changes","Informative References":"CCMv4.0: CCC-04\nCCMv4.0: DCS-06\nCCMv4.0: DSP-19\nCCMv4.0: UEM-02\nCCMv4.0: UEM-04\nCIS Controls v8.0: 2.1\nCRI Profile v2.0: ID.AM-02\nCRI Profile v2.0: ID.AM-02.01\nCSF v1.1: ID.AM-2\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: AC-20\nSP 800-53 Rev 5.1.1: CM-08\nSP 800-53 Rev 5.1.1: PM-05\nSP 800-53 Rev 5.1.1: SA-05\nSP 800-53 Rev 5.1.1: SA-09","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"A software inventory update function would need to be configured to operate with SecOps.  This would require further research","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-02","Subcategory Description":" Inventories of software, services, and systems managed by the organization are maintained","Implementation Examples":"Ex3","Example Description":" Maintain an inventory of the organization's systems","Informative References":"CCMv4.0: CCC-04\nCCMv4.0: DCS-06\nCCMv4.0: DSP-19\nCCMv4.0: UEM-02\nCCMv4.0: UEM-04\nCIS Controls v8.0: 2.1\nCRI Profile v2.0: ID.AM-02\nCRI Profile v2.0: ID.AM-02.01\nCSF v1.1: ID.AM-2\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: AC-20\nSP 800-53 Rev 5.1.1: CM-08\nSP 800-53 Rev 5.1.1: PM-05\nSP 800-53 Rev 5.1.1: SA-05\nSP 800-53 Rev 5.1.1: SA-09","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"This query pulls the same information that is contained in ID.AM-01 Ex1","Linked Query":"ID.AM-01 Ex1","Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$hostname = group($e.principal.hostname,$e.target.hostname,$e.src.hostname,$e.intermediary.hostname,$e.observer.hostname,$e.principal.asset.hostname,$e.src.asset.hostname,$e.target.asset.hostname)\n$hostname = \/.*\/\nmatch:\n    $hostname\noutcome:\n\t$logsSeen = array_distinct($e.metadata.log_type)\norder:\n\t$hostname","API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-05","Subcategory Description":" Assets are prioritized based on classification, criticality, resources, and impact on the mission","Implementation Examples":"Ex1","Example Description":" Define criteria for prioritizing each class of assets","Informative References":"CCMv4.0: CEK-04\nCCMv4.0: DCS-05\nCCMv4.0: DSP-04\nCIS Controls v8.0: 3.7\nCRI Profile v2.0: ID.AM-05\nCRI Profile v2.0: ID.AM-05.01\nCRI Profile v2.0: ID.AM-05.02\nCSF v1.1: ID.AM-5\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-09\nSP 800-53 Rev 5.1.1: RA-02","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would require a policy, and cannot be done programmatically.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-05","Subcategory Description":" Assets are prioritized based on classification, criticality, resources, and impact on the mission","Implementation Examples":"Ex2","Example Description":" Apply the prioritization criteria to assets","Informative References":"CCMv4.0: CEK-04\nCCMv4.0: DCS-05\nCCMv4.0: DSP-04\nCIS Controls v8.0: 3.7\nCRI Profile v2.0: ID.AM-05\nCRI Profile v2.0: ID.AM-05.01\nCRI Profile v2.0: ID.AM-05.02\nCSF v1.1: ID.AM-5\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-09\nSP 800-53 Rev 5.1.1: RA-02","Exportable From SIEM":"No","API":"Requires SecOps ingesting custom labeling.","Difficulty":null,"Comments":"This could be done as a custom label when ingesting data from a source uploading asset data (for example, Cybriant Axonius Asset Uploader, or the Active Directory Powershell scripts that upload asset data).","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-05","Subcategory Description":" Assets are prioritized based on classification, criticality, resources, and impact on the mission","Implementation Examples":"Ex3","Example Description":" Track the asset priorities and update them periodically or when significant changes to the organization occur","Informative References":"CCMv4.0: CEK-04\nCCMv4.0: DCS-05\nCCMv4.0: DSP-04\nCIS Controls v8.0: 3.7\nCRI Profile v2.0: ID.AM-05\nCRI Profile v2.0: ID.AM-05.01\nCRI Profile v2.0: ID.AM-05.02\nCSF v1.1: ID.AM-5\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-09\nSP 800-53 Rev 5.1.1: RA-02","Exportable From SIEM":"No","API":"Requires SecOps ingesting custom labeling.","Difficulty":null,"Comments":"This could be done as a custom label when ingesting data from a source uploading asset data (for example, Cybriant Axonius Asset Uploader, or the Active Directory Powershell scripts that upload asset data).","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-07","Subcategory Description":" Inventories of data and corresponding metadata for designated data types are maintained","Implementation Examples":"Ex1","Example Description":" Maintain a list of the designated data types of interest (e.g., personally identifiable information, protected health information, financial account numbers, organization intellectual property, operational technology data)","Informative References":"CCMv4.0: DSP-01\nCCMv4.0: DSP-03\nCCMv4.0: DSP-04\nCCMv4.0: DSP-06\nCCMv4.0: DSP-10\nCCMv4.0: DSP-19\nCCMv4.0: UEM-02\nCIS Controls v8.0: 3.2\nCRI Profile v2.0: ID.AM-07\nCRI Profile v2.0: ID.AM-07.01\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: CM-12\nSP 800-53 Rev 5.1.1: CM-13\nSP 800-53 Rev 5.1.1: SI-12","Exportable From SIEM":"No","API":"Requires SecOps ingesting custom labeling.","Difficulty":null,"Comments":"This could be accomplished via custom labels, and extending the ingested logs from the log source with the appropriate data source type (PII, protected health information, financial account numbers, etc)","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-07","Subcategory Description":" Inventories of data and corresponding metadata for designated data types are maintained","Implementation Examples":"Ex2","Example Description":" Continuously discover and analyze ad hoc data to identify new instances of designated data types","Informative References":"CCMv4.0: DSP-01\nCCMv4.0: DSP-03\nCCMv4.0: DSP-04\nCCMv4.0: DSP-06\nCCMv4.0: DSP-10\nCCMv4.0: DSP-19\nCCMv4.0: UEM-02\nCIS Controls v8.0: 3.2\nCRI Profile v2.0: ID.AM-07\nCRI Profile v2.0: ID.AM-07.01\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: CM-12\nSP 800-53 Rev 5.1.1: CM-13\nSP 800-53 Rev 5.1.1: SI-12","Exportable From SIEM":"No","API":"Requires SecOps ingesting custom labeling.","Difficulty":null,"Comments":"This would require a custom query based on the specific data source.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-07","Subcategory Description":" Inventories of data and corresponding metadata for designated data types are maintained","Implementation Examples":"Ex3","Example Description":" Assign data classifications to designated data types through tags or labels","Informative References":"CCMv4.0: DSP-01\nCCMv4.0: DSP-03\nCCMv4.0: DSP-04\nCCMv4.0: DSP-06\nCCMv4.0: DSP-10\nCCMv4.0: DSP-19\nCCMv4.0: UEM-02\nCIS Controls v8.0: 3.2\nCRI Profile v2.0: ID.AM-07\nCRI Profile v2.0: ID.AM-07.01\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: CM-12\nSP 800-53 Rev 5.1.1: CM-13\nSP 800-53 Rev 5.1.1: SI-12","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be handled via organizational policy, or by a DLP technology to auto-label based specific requirements.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Asset Management (ID.AM)","Category Description":" Assets (e.g., data, hardware, software, systems, facilities, services, people) that enable the organization to achieve business purposes are identified and managed consistent with their relative importance to organizational objectives and the organization's risk strategy","Subcategory":"ID.AM-07","Subcategory Description":" Inventories of data and corresponding metadata for designated data types are maintained","Implementation Examples":"Ex4","Example Description":" Track the provenance, data owner, and geolocation of each instance of designated data types","Informative References":"CCMv4.0: DSP-01\nCCMv4.0: DSP-03\nCCMv4.0: DSP-04\nCCMv4.0: DSP-06\nCCMv4.0: DSP-10\nCCMv4.0: DSP-19\nCCMv4.0: UEM-02\nCIS Controls v8.0: 3.2\nCRI Profile v2.0: ID.AM-07\nCRI Profile v2.0: ID.AM-07.01\nSP 800-221A: MA.RI-1\nSP 800-53 Rev 5.1.1: CM-12\nSP 800-53 Rev 5.1.1: CM-13\nSP 800-53 Rev 5.1.1: SI-12","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Custom","Comments":"This need to be based on specific data log sources.  For example, some Azure Active Directory logs will provide this information.","Linked Query":false,"Vendor":"CustomRequired","Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-01","Subcategory Description":" Vulnerabilities in assets are identified, validated, and recorded","Implementation Examples":"Ex1","Example Description":" Use vulnerability management technologies to identify unpatched and misconfigured software","Informative References":"CCMv4.0: AIS-05\nCCMv4.0: AIS-07\nCCMv4.0: TVM-01\nCCMv4.0: TVM-03\nCCMv4.0: TVM-05\nCCMv4.0: TVM-06\nCCMv4.0: TVM-07\nCCMv4.0: TVM-08\nCCMv4.0: TVM-09\nCCMv4.0: TVM-10\nCIS Controls v8.0: 7.1\nCRI Profile v2.0: ID.RA-01\nCRI Profile v2.0: ID.RA-01.01\nCRI Profile v2.0: ID.RA-01.02\nCRI Profile v2.0: ID.RA-01.03\nCSF v1.1: ID.RA-1\nCSF v1.1: PR.IP-12\nCSF v1.1: DE.CM-8\nSP 800-218: PO.5.2\nSP 800-221A: MA.RI-3\nSP 800-53 Rev 5.1.1: CA-02\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CA-08\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-05\nSP 800-53 Rev 5.1.1: SA-11(02)\nSP 800-53 Rev 5.1.1: SA-15(07)\nSP 800-53 Rev 5.1.1: SA-15(08)\nSP 800-53 Rev 5.1.1: SI-04\nSP 800-53 Rev 5.1.1: SI-05","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Unverified","Comments":"This requires a vulnerability scanning technology that can upload vulnerability results to SecOps.  For example:  Tenable.io or Qualys.","Linked Query":false,"Vendor":"Agnostic","Query Version":"Alpha","Dashboard Name":null,"Pretty Print Queries":"$vulnerability = $e.about.asset.vulnerabilities.name \n$vulnerability = \/.*\/\n\nmatch:\n    $vulnerability\n\noutcome: \n    $hostname = array_distinct($e.about.asset.hostname)\n    $vendor = array_distinct($e.about.asset.vulnerabilities.vendor)\n    $severity = array_distinct($e.about.asset.vulnerabilities.severity)\n    $lastScan = timestamp.get_date(max($e.about.asset.vulnerabilities.last_found.seconds))\n\norder:\n    $hostname","API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-01","Subcategory Description":" Vulnerabilities in assets are identified, validated, and recorded","Implementation Examples":"Ex2","Example Description":" Assess network and system architectures for design and implementation weaknesses that affect cybersecurity","Informative References":"CCMv4.0: AIS-05\nCCMv4.0: AIS-07\nCCMv4.0: TVM-01\nCCMv4.0: TVM-03\nCCMv4.0: TVM-05\nCCMv4.0: TVM-06\nCCMv4.0: TVM-07\nCCMv4.0: TVM-08\nCCMv4.0: TVM-09\nCCMv4.0: TVM-10\nCIS Controls v8.0: 7.1\nCRI Profile v2.0: ID.RA-01\nCRI Profile v2.0: ID.RA-01.01\nCRI Profile v2.0: ID.RA-01.02\nCRI Profile v2.0: ID.RA-01.03\nCSF v1.1: ID.RA-1\nCSF v1.1: PR.IP-12\nCSF v1.1: DE.CM-8\nSP 800-218: PO.5.2\nSP 800-221A: MA.RI-3\nSP 800-53 Rev 5.1.1: CA-02\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CA-08\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-05\nSP 800-53 Rev 5.1.1: SA-11(02)\nSP 800-53 Rev 5.1.1: SA-15(07)\nSP 800-53 Rev 5.1.1: SA-15(08)\nSP 800-53 Rev 5.1.1: SI-04\nSP 800-53 Rev 5.1.1: SI-05","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be handled via organizational policy, diagrams, and review of related information.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-01","Subcategory Description":" Vulnerabilities in assets are identified, validated, and recorded","Implementation Examples":"Ex3","Example Description":" Review, analyze, or test organization-developed software to identify design, coding, and default configuration vulnerabilities","Informative References":"CCMv4.0: AIS-05\nCCMv4.0: AIS-07\nCCMv4.0: TVM-01\nCCMv4.0: TVM-03\nCCMv4.0: TVM-05\nCCMv4.0: TVM-06\nCCMv4.0: TVM-07\nCCMv4.0: TVM-08\nCCMv4.0: TVM-09\nCCMv4.0: TVM-10\nCIS Controls v8.0: 7.1\nCRI Profile v2.0: ID.RA-01\nCRI Profile v2.0: ID.RA-01.01\nCRI Profile v2.0: ID.RA-01.02\nCRI Profile v2.0: ID.RA-01.03\nCSF v1.1: ID.RA-1\nCSF v1.1: PR.IP-12\nCSF v1.1: DE.CM-8\nSP 800-218: PO.5.2\nSP 800-221A: MA.RI-3\nSP 800-53 Rev 5.1.1: CA-02\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CA-08\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-05\nSP 800-53 Rev 5.1.1: SA-11(02)\nSP 800-53 Rev 5.1.1: SA-15(07)\nSP 800-53 Rev 5.1.1: SA-15(08)\nSP 800-53 Rev 5.1.1: SI-04\nSP 800-53 Rev 5.1.1: SI-05","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be handled via organizational policy, source code, and review of related information.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-01","Subcategory Description":" Vulnerabilities in assets are identified, validated, and recorded","Implementation Examples":"Ex4","Example Description":" Assess facilities that house critical computing assets for physical vulnerabilities and resilience issues","Informative References":"CCMv4.0: AIS-05\nCCMv4.0: AIS-07\nCCMv4.0: TVM-01\nCCMv4.0: TVM-03\nCCMv4.0: TVM-05\nCCMv4.0: TVM-06\nCCMv4.0: TVM-07\nCCMv4.0: TVM-08\nCCMv4.0: TVM-09\nCCMv4.0: TVM-10\nCIS Controls v8.0: 7.1\nCRI Profile v2.0: ID.RA-01\nCRI Profile v2.0: ID.RA-01.01\nCRI Profile v2.0: ID.RA-01.02\nCRI Profile v2.0: ID.RA-01.03\nCSF v1.1: ID.RA-1\nCSF v1.1: PR.IP-12\nCSF v1.1: DE.CM-8\nSP 800-218: PO.5.2\nSP 800-221A: MA.RI-3\nSP 800-53 Rev 5.1.1: CA-02\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CA-08\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-05\nSP 800-53 Rev 5.1.1: SA-11(02)\nSP 800-53 Rev 5.1.1: SA-15(07)\nSP 800-53 Rev 5.1.1: SA-15(08)\nSP 800-53 Rev 5.1.1: SI-04\nSP 800-53 Rev 5.1.1: SI-05","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be handled via organizational policy, physical infrastructure facilities, and review of related information.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-01","Subcategory Description":" Vulnerabilities in assets are identified, validated, and recorded","Implementation Examples":"Ex5","Example Description":" Monitor sources of cyber threat intelligence for information on new vulnerabilities in products and services","Informative References":"CCMv4.0: AIS-05\nCCMv4.0: AIS-07\nCCMv4.0: TVM-01\nCCMv4.0: TVM-03\nCCMv4.0: TVM-05\nCCMv4.0: TVM-06\nCCMv4.0: TVM-07\nCCMv4.0: TVM-08\nCCMv4.0: TVM-09\nCCMv4.0: TVM-10\nCIS Controls v8.0: 7.1\nCRI Profile v2.0: ID.RA-01\nCRI Profile v2.0: ID.RA-01.01\nCRI Profile v2.0: ID.RA-01.02\nCRI Profile v2.0: ID.RA-01.03\nCSF v1.1: ID.RA-1\nCSF v1.1: PR.IP-12\nCSF v1.1: DE.CM-8\nSP 800-218: PO.5.2\nSP 800-221A: MA.RI-3\nSP 800-53 Rev 5.1.1: CA-02\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CA-08\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-05\nSP 800-53 Rev 5.1.1: SA-11(02)\nSP 800-53 Rev 5.1.1: SA-15(07)\nSP 800-53 Rev 5.1.1: SA-15(08)\nSP 800-53 Rev 5.1.1: SI-04\nSP 800-53 Rev 5.1.1: SI-05","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This may be harvestable if Google is ingesting a custom threat feed, and the feeds API it utilized to determine whether it is functioning correctly.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-01","Subcategory Description":" Vulnerabilities in assets are identified, validated, and recorded","Implementation Examples":"Ex6","Example Description":" Review processes and procedures for weaknesses that could be exploited to affect cybersecurity","Informative References":"CCMv4.0: AIS-05\nCCMv4.0: AIS-07\nCCMv4.0: TVM-01\nCCMv4.0: TVM-03\nCCMv4.0: TVM-05\nCCMv4.0: TVM-06\nCCMv4.0: TVM-07\nCCMv4.0: TVM-08\nCCMv4.0: TVM-09\nCCMv4.0: TVM-10\nCIS Controls v8.0: 7.1\nCRI Profile v2.0: ID.RA-01\nCRI Profile v2.0: ID.RA-01.01\nCRI Profile v2.0: ID.RA-01.02\nCRI Profile v2.0: ID.RA-01.03\nCSF v1.1: ID.RA-1\nCSF v1.1: PR.IP-12\nCSF v1.1: DE.CM-8\nSP 800-218: PO.5.2\nSP 800-221A: MA.RI-3\nSP 800-53 Rev 5.1.1: CA-02\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CA-08\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-05\nSP 800-53 Rev 5.1.1: SA-11(02)\nSP 800-53 Rev 5.1.1: SA-15(07)\nSP 800-53 Rev 5.1.1: SA-15(08)\nSP 800-53 Rev 5.1.1: SI-04\nSP 800-53 Rev 5.1.1: SI-05","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be handled via organizational review according to policy and procedures.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-02","Subcategory Description":" Cyber threat intelligence is received from information sharing forums and sources","Implementation Examples":"Ex1","Example Description":" Configure cybersecurity tools and technologies with detection or response capabilities to securely ingest cyber threat intelligence feeds","Informative References":"CCMv4.0: GRC-08\nCCMv4.0: TVM-04\nCRI Profile v2.0: ID.RA-02\nCRI Profile v2.0: ID.RA-02.01\nCRI Profile v2.0: ID.RA-02.02\nCSF v1.1: ID.RA-2\nSP 800-221A: GV.BE-4\nSP 800-53 Rev 5.1.1: SI-05\nSP 800-53 Rev 5.1.1: PM-15\nSP 800-53 Rev 5.1.1: PM-16","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This may be harvestable if Google is ingesting a custom threat feed, and the feeds API it utilized to determine whether it is functioning correctly.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-02","Subcategory Description":" Cyber threat intelligence is received from information sharing forums and sources","Implementation Examples":"Ex2","Example Description":" Receive and review advisories from reputable third parties on current threat actors and their tactics, techniques, and procedures (TTPs)","Informative References":"CCMv4.0: GRC-08\nCCMv4.0: TVM-04\nCRI Profile v2.0: ID.RA-02\nCRI Profile v2.0: ID.RA-02.01\nCRI Profile v2.0: ID.RA-02.02\nCSF v1.1: ID.RA-2\nSP 800-221A: GV.BE-4\nSP 800-53 Rev 5.1.1: SI-05\nSP 800-53 Rev 5.1.1: PM-15\nSP 800-53 Rev 5.1.1: PM-16","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would need to be performed manually, and should be done in accordance with organizational policys and procedures.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-02","Subcategory Description":" Cyber threat intelligence is received from information sharing forums and sources","Implementation Examples":"Ex3","Example Description":" Monitor sources of cyber threat intelligence for information on the types of vulnerabilities that emerging technologies may have","Informative References":"CCMv4.0: GRC-08\nCCMv4.0: TVM-04\nCRI Profile v2.0: ID.RA-02\nCRI Profile v2.0: ID.RA-02.01\nCRI Profile v2.0: ID.RA-02.02\nCSF v1.1: ID.RA-2\nSP 800-221A: GV.BE-4\nSP 800-53 Rev 5.1.1: SI-05\nSP 800-53 Rev 5.1.1: PM-15\nSP 800-53 Rev 5.1.1: PM-16","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This may be harvestable if Google is ingesting a custom threat feed, and the feeds API it utilized to determine whether it is functioning correctly.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-03","Subcategory Description":" Internal and external threats to the organization are identified and recorded","Implementation Examples":"Ex1","Example Description":" Use cyber threat intelligence to maintain awareness of the types of threat actors likely to target the organization and the TTPs they are likely to use","Informative References":"CCMv4.0: A&A-05\nCCMv4.0: TVM-05\nCRI Profile v2.0: ID.RA-03\nCRI Profile v2.0: ID.RA-03.01\nCRI Profile v2.0: ID.RA-03.02\nCRI Profile v2.0: ID.RA-03.03\nCRI Profile v2.0: ID.RA-03.04\nCSF v1.1: ID.RA-3\nSP 800-221A: MA.RI-2\nSP 800-53 Rev 5.1.1: PM-12\nSP 800-53 Rev 5.1.1: PM-16\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: SI-05","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be handled via orgnizational policies and policies, and via due diligence by staff through security awareness (phishing education, CISA alerts, ISAC reports, et cetera.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-03","Subcategory Description":" Internal and external threats to the organization are identified and recorded","Implementation Examples":"Ex2","Example Description":" Perform threat hunting to look for signs of threat actors within the environment","Informative References":"CCMv4.0: A&A-05\nCCMv4.0: TVM-05\nCRI Profile v2.0: ID.RA-03\nCRI Profile v2.0: ID.RA-03.01\nCRI Profile v2.0: ID.RA-03.02\nCRI Profile v2.0: ID.RA-03.03\nCRI Profile v2.0: ID.RA-03.04\nCSF v1.1: ID.RA-3\nSP 800-221A: MA.RI-2\nSP 800-53 Rev 5.1.1: PM-12\nSP 800-53 Rev 5.1.1: PM-16\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: SI-05","Exportable From SIEM":"Yes","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"It appears that Shared Saved Searches can be retrieved via the API.  Specifically, the IAM permissions lists the permission:  chronicle.searchQueries.list and the API method:  UserDataService.ListSearchQueries\/.  \n\nThis will require further information.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"IDENTIFY (ID): The organization's current cybersecurity risks are understood","Category":"Risk Assessment (ID.RA)","Category Description":" The cybersecurity risk to the organization, assets, and individuals is understood by the organization","Subcategory":"ID.RA-03","Subcategory Description":" Internal and external threats to the organization are identified and recorded","Implementation Examples":"Ex3","Example Description":" Implement processes for identifying internal threat actors","Informative References":"CCMv4.0: A&A-05\nCCMv4.0: TVM-05\nCRI Profile v2.0: ID.RA-03\nCRI Profile v2.0: ID.RA-03.01\nCRI Profile v2.0: ID.RA-03.02\nCRI Profile v2.0: ID.RA-03.03\nCRI Profile v2.0: ID.RA-03.04\nCSF v1.1: ID.RA-3\nSP 800-221A: MA.RI-2\nSP 800-53 Rev 5.1.1: PM-12\nSP 800-53 Rev 5.1.1: PM-16\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: SI-05","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be handled via organizational policies and procedures.  However, there are some SecOps rules that will identify potential insider threats.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-01","Subcategory Description":" Identities and credentials for authorized users, services, and hardware are managed by the organization","Implementation Examples":"Ex1","Example Description":" Initiate requests for new access or additional access for employees, contractors, and others, and track, review, and fulfill the requests, with permission from system or data owners when needed","Informative References":"CCMv4.0: CEK-01\nCCMv4.0: CEK-10\nCCMv4.0: CEK-11\nCCMv4.0: CEK-12\nCCMv4.0: CEK-13\nCCMv4.0: CEK-14\nCCMv4.0: CEK-15\nCCMv4.0: CEK-16\nCCMv4.0: CEK-17\nCCMv4.0: CEK-18\nCCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: CEK-21\nCCMv4.0: DCS-08\nCCMv4.0: IAM-01\nCCMv4.0: IAM-03\nCCMv4.0: IAM-06\nCCMv4.0: IAM-07\nCCMv4.0: IAM-09\nCCMv4.0: IAM-13\nCCMv4.0: IAM-14\nCCMv4.0: IAM-15\nCCMv4.0: IAM-16\nCCMv4.0: UEM-14\nCIS Controls v8.0: 5.1\nCIS Controls v8.0: 6.7\nCRI Profile v2.0: PR.AA-01\nCRI Profile v2.0: PR.AA-01.01\nCRI Profile v2.0: PR.AA-01.02\nCSF v1.1: PR.AC-1\nSP 800-53 Rev 5.1.1: AC-01\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AC-14\nSP 800-53 Rev 5.1.1: IA-01\nSP 800-53 Rev 5.1.1: IA-02\nSP 800-53 Rev 5.1.1: IA-03\nSP 800-53 Rev 5.1.1: IA-04\nSP 800-53 Rev 5.1.1: IA-05\nSP 800-53 Rev 5.1.1: IA-06\nSP 800-53 Rev 5.1.1: IA-07\nSP 800-53 Rev 5.1.1: IA-08\nSP 800-53 Rev 5.1.1: IA-09\nSP 800-53 Rev 5.1.1: IA-10\nSP 800-53 Rev 5.1.1: IA-11","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be performed via policies and procedures.  Evidence would likely be gathered via tickets.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-01","Subcategory Description":" Identities and credentials for authorized users, services, and hardware are managed by the organization","Implementation Examples":"Ex2","Example Description":" Issue, manage, and revoke cryptographic certificates and identity tokens, cryptographic keys (i.e., key management), and other credentials","Informative References":"CCMv4.0: CEK-01\nCCMv4.0: CEK-10\nCCMv4.0: CEK-11\nCCMv4.0: CEK-12\nCCMv4.0: CEK-13\nCCMv4.0: CEK-14\nCCMv4.0: CEK-15\nCCMv4.0: CEK-16\nCCMv4.0: CEK-17\nCCMv4.0: CEK-18\nCCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: CEK-21\nCCMv4.0: DCS-08\nCCMv4.0: IAM-01\nCCMv4.0: IAM-03\nCCMv4.0: IAM-06\nCCMv4.0: IAM-07\nCCMv4.0: IAM-09\nCCMv4.0: IAM-13\nCCMv4.0: IAM-14\nCCMv4.0: IAM-15\nCCMv4.0: IAM-16\nCCMv4.0: UEM-14\nCIS Controls v8.0: 5.1\nCIS Controls v8.0: 6.7\nCRI Profile v2.0: PR.AA-01\nCRI Profile v2.0: PR.AA-01.01\nCRI Profile v2.0: PR.AA-01.02\nCSF v1.1: PR.AC-1\nSP 800-53 Rev 5.1.1: AC-01\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AC-14\nSP 800-53 Rev 5.1.1: IA-01\nSP 800-53 Rev 5.1.1: IA-02\nSP 800-53 Rev 5.1.1: IA-03\nSP 800-53 Rev 5.1.1: IA-04\nSP 800-53 Rev 5.1.1: IA-05\nSP 800-53 Rev 5.1.1: IA-06\nSP 800-53 Rev 5.1.1: IA-07\nSP 800-53 Rev 5.1.1: IA-08\nSP 800-53 Rev 5.1.1: IA-09\nSP 800-53 Rev 5.1.1: IA-10\nSP 800-53 Rev 5.1.1: IA-11","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"Evidence of these actions should be discoverable in the logs.  However, it will take research to determine which logs would be appropriate.","Linked Query":false,"Vendor":"Microsoft Azure","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$e.additional.fields[\"targetResources.modifiedProperties.newValue 0\"] = \/KeyIdentifier.*\/\n$e.additional.fields[\"targetResources.modifiedProperties.oldValue 0\"] = \/KeyIdentifier.*\/\n$e.metadata.log_type = \"AZURE_AD_AUDIT\"\n$e.metadata.product_event_type = \"Update application \u2013 Certificates and secrets management \"\n\n$date = timestamp.get_date($e.metadata.event_timestamp.seconds)\n\nmatch:\n    $date\n\noutcome:\n    $user_id = array_distinct($e.principal.user.userid)\n    $old_key = array_distinct($e.additional.fields[\"targetResources.modifiedProperties.oldValue 0\"])\n    $new_key = array_distinct($e.additional.fields[\"targetResources.modifiedProperties.newValue 0\"])\n\norder:\n    $date\n\nlimit: 25","API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-01","Subcategory Description":" Identities and credentials for authorized users, services, and hardware are managed by the organization","Implementation Examples":"Ex3","Example Description":" Select a unique identifier for each device from immutable hardware characteristics or an identifier securely provisioned to the device","Informative References":"CCMv4.0: CEK-01\nCCMv4.0: CEK-10\nCCMv4.0: CEK-11\nCCMv4.0: CEK-12\nCCMv4.0: CEK-13\nCCMv4.0: CEK-14\nCCMv4.0: CEK-15\nCCMv4.0: CEK-16\nCCMv4.0: CEK-17\nCCMv4.0: CEK-18\nCCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: CEK-21\nCCMv4.0: DCS-08\nCCMv4.0: IAM-01\nCCMv4.0: IAM-03\nCCMv4.0: IAM-06\nCCMv4.0: IAM-07\nCCMv4.0: IAM-09\nCCMv4.0: IAM-13\nCCMv4.0: IAM-14\nCCMv4.0: IAM-15\nCCMv4.0: IAM-16\nCCMv4.0: UEM-14\nCIS Controls v8.0: 5.1\nCIS Controls v8.0: 6.7\nCRI Profile v2.0: PR.AA-01\nCRI Profile v2.0: PR.AA-01.01\nCRI Profile v2.0: PR.AA-01.02\nCSF v1.1: PR.AC-1\nSP 800-53 Rev 5.1.1: AC-01\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AC-14\nSP 800-53 Rev 5.1.1: IA-01\nSP 800-53 Rev 5.1.1: IA-02\nSP 800-53 Rev 5.1.1: IA-03\nSP 800-53 Rev 5.1.1: IA-04\nSP 800-53 Rev 5.1.1: IA-05\nSP 800-53 Rev 5.1.1: IA-06\nSP 800-53 Rev 5.1.1: IA-07\nSP 800-53 Rev 5.1.1: IA-08\nSP 800-53 Rev 5.1.1: IA-09\nSP 800-53 Rev 5.1.1: IA-10\nSP 800-53 Rev 5.1.1: IA-11","Exportable From SIEM":"Yes","API":"Dashboard Export API","Difficulty":"Done","Comments":"A UUID, GUID, MAC or other standard identifier should be discovered from most asset reporting log types.\n\nThe pretty print query does NOT work.  However, a SecOps dashboard has been created showing the relevant information.  Theoretically, the query or something similar should work.\n\nDashboard Name:  R28 PR.AA-01 Ex3 - Unique Identifier for Assets","Linked Query":false,"Vendor":"Agnostic","Query Version":"Beta","Dashboard Name":"R28 PR.AA-01 Ex3 - Unique Identifier for Assets","Pretty Print Queries":"$hostname =  group($e.principal.hostname,$e.target.hostname,$e.src.hostname,$e.intermediary.hostname,$e.observer.hostname,$e.principal.asset.hostname,$e.src.asset.hostname,$e.target.asset.hostname)\n$e.about.asset.mac != \"\"\n\nmatch:\n    $hostname\n\noutcome:\n    $macAddrs = array_distinct($e.about.asset.mac)\n    $firstSeen = timestamp.get_date(min($e.metadata.event_timestamp.seconds))\n    $lastSeen = timestamp.get_date(max($e.metadata.event_timestamp.seconds))\n\norder:\n    $hostname","API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-01","Subcategory Description":" Identities and credentials for authorized users, services, and hardware are managed by the organization","Implementation Examples":"Ex4","Example Description":" Physically label authorized hardware with an identifier for inventory and servicing purposes","Informative References":"CCMv4.0: CEK-01\nCCMv4.0: CEK-10\nCCMv4.0: CEK-11\nCCMv4.0: CEK-12\nCCMv4.0: CEK-13\nCCMv4.0: CEK-14\nCCMv4.0: CEK-15\nCCMv4.0: CEK-16\nCCMv4.0: CEK-17\nCCMv4.0: CEK-18\nCCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: CEK-21\nCCMv4.0: DCS-08\nCCMv4.0: IAM-01\nCCMv4.0: IAM-03\nCCMv4.0: IAM-06\nCCMv4.0: IAM-07\nCCMv4.0: IAM-09\nCCMv4.0: IAM-13\nCCMv4.0: IAM-14\nCCMv4.0: IAM-15\nCCMv4.0: IAM-16\nCCMv4.0: UEM-14\nCIS Controls v8.0: 5.1\nCIS Controls v8.0: 6.7\nCRI Profile v2.0: PR.AA-01\nCRI Profile v2.0: PR.AA-01.01\nCRI Profile v2.0: PR.AA-01.02\nCSF v1.1: PR.AC-1\nSP 800-53 Rev 5.1.1: AC-01\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AC-14\nSP 800-53 Rev 5.1.1: IA-01\nSP 800-53 Rev 5.1.1: IA-02\nSP 800-53 Rev 5.1.1: IA-03\nSP 800-53 Rev 5.1.1: IA-04\nSP 800-53 Rev 5.1.1: IA-05\nSP 800-53 Rev 5.1.1: IA-06\nSP 800-53 Rev 5.1.1: IA-07\nSP 800-53 Rev 5.1.1: IA-08\nSP 800-53 Rev 5.1.1: IA-09\nSP 800-53 Rev 5.1.1: IA-10\nSP 800-53 Rev 5.1.1: IA-11","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This requires physical interaction with the device to label it.  No logs would be sent to a SIEM.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-03","Subcategory Description":" Users, services, and hardware are authenticated","Implementation Examples":"Ex1","Example Description":" Require multifactor authentication","Informative References":"CCMv4.0: DCS-08\nCCMv4.0: IAM-01\nCCMv4.0: IAM-02\nCCMv4.0: IAM-14\nCCMv4.0: IAM-16\nCCMv4.0: IVS-03\nCCMv4.0: UEM-05\nCCMv4.0: UEM-06\nCCMv4.0: UEM-14\nCRI Profile v2.0: PR.AA-03\nCRI Profile v2.0: PR.AA-03.01\nCRI Profile v2.0: PR.AA-03.02\nCRI Profile v2.0: PR.AA-03.03\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-7\nSP 800-218: PO.5.2\nSP 800-53 Rev 5.1.1: AC-07\nSP 800-53 Rev 5.1.1: AC-12\nSP 800-53 Rev 5.1.1: IA-02\nSP 800-53 Rev 5.1.1: IA-03\nSP 800-53 Rev 5.1.1: IA-05\nSP 800-53 Rev 5.1.1: IA-07\nSP 800-53 Rev 5.1.1: IA-08\nSP 800-53 Rev 5.1.1: IA-09\nSP 800-53 Rev 5.1.1: IA-10\nSP 800-53 Rev 5.1.1: IA-11","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"Enforcement of MFA requirements would have to be acquired via configuration review.  However, reviewing MFA logs would provide evidence that the MFA polies are successfully in place.","Linked Query":false,"Vendor":"Microsoft Azure","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$userLogin.metadata.event_type = \"USER_LOGIN\" \n($userLogin.security_result.description = \"MFA completed in Azure AD\" OR $userLogin.security_result.description = \"MFA requirement satisfied by claim in the token\")\n$userLogin.target.user.userid = $targetUser\n\nmatch:\n    $targetUser\n\noutcome:\n    $LoginFromHosts = array_distinct($userLogin.principal.asset.hostname)\n    $MfaResult = array_distinct($userLogin.security_result.description)\n\norder:\n    $targetUser","API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-03","Subcategory Description":" Users, services, and hardware are authenticated","Implementation Examples":"Ex2","Example Description":" Enforce policies for the minimum strength of passwords, PINs, and similar authenticators","Informative References":"CCMv4.0: DCS-08\nCCMv4.0: IAM-01\nCCMv4.0: IAM-02\nCCMv4.0: IAM-14\nCCMv4.0: IAM-16\nCCMv4.0: IVS-03\nCCMv4.0: UEM-05\nCCMv4.0: UEM-06\nCCMv4.0: UEM-14\nCRI Profile v2.0: PR.AA-03\nCRI Profile v2.0: PR.AA-03.01\nCRI Profile v2.0: PR.AA-03.02\nCRI Profile v2.0: PR.AA-03.03\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-7\nSP 800-218: PO.5.2\nSP 800-53 Rev 5.1.1: AC-07\nSP 800-53 Rev 5.1.1: AC-12\nSP 800-53 Rev 5.1.1: IA-02\nSP 800-53 Rev 5.1.1: IA-03\nSP 800-53 Rev 5.1.1: IA-05\nSP 800-53 Rev 5.1.1: IA-07\nSP 800-53 Rev 5.1.1: IA-08\nSP 800-53 Rev 5.1.1: IA-09\nSP 800-53 Rev 5.1.1: IA-10\nSP 800-53 Rev 5.1.1: IA-11","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would have to be acquired via configuration review.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-03","Subcategory Description":" Users, services, and hardware are authenticated","Implementation Examples":"Ex3","Example Description":" Periodically reauthenticate users, services, and hardware based on risk (e.g., in zero trust architectures)","Informative References":"CCMv4.0: DCS-08\nCCMv4.0: IAM-01\nCCMv4.0: IAM-02\nCCMv4.0: IAM-14\nCCMv4.0: IAM-16\nCCMv4.0: IVS-03\nCCMv4.0: UEM-05\nCCMv4.0: UEM-06\nCCMv4.0: UEM-14\nCRI Profile v2.0: PR.AA-03\nCRI Profile v2.0: PR.AA-03.01\nCRI Profile v2.0: PR.AA-03.02\nCRI Profile v2.0: PR.AA-03.03\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-7\nSP 800-218: PO.5.2\nSP 800-53 Rev 5.1.1: AC-07\nSP 800-53 Rev 5.1.1: AC-12\nSP 800-53 Rev 5.1.1: IA-02\nSP 800-53 Rev 5.1.1: IA-03\nSP 800-53 Rev 5.1.1: IA-05\nSP 800-53 Rev 5.1.1: IA-07\nSP 800-53 Rev 5.1.1: IA-08\nSP 800-53 Rev 5.1.1: IA-09\nSP 800-53 Rev 5.1.1: IA-10\nSP 800-53 Rev 5.1.1: IA-11","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"Evidence would likely need to be acquired by configuration review.  However, it should be possible to verify that entities are reauthenticated peridiocally via the logs.\n\nNote:  Current version creates a row per user, and then has a list of all applications and the total count of ALLOW eventsf ro USER_LOGIN.  This does NOT separate each application for login count to be shown per application.","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$user = $e.target.user.userid\n$user = \/.*\/\n$e.metadata.event_type = \"USER_LOGIN\"\n$e.security_result.action = \"ALLOW\"\n\nmatch:\n    $user over 24h\n\noutcome:\n    $targetApplication = array_distinct($e.target.application)\n    $timesAuthenticated = count($e.target.application)\n\nlimit:  100","API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-03","Subcategory Description":" Users, services, and hardware are authenticated","Implementation Examples":"Ex4","Example Description":" Ensure that authorized personnel can access accounts essential for protecting safety under emergency conditions","Informative References":"CCMv4.0: DCS-08\nCCMv4.0: IAM-01\nCCMv4.0: IAM-02\nCCMv4.0: IAM-14\nCCMv4.0: IAM-16\nCCMv4.0: IVS-03\nCCMv4.0: UEM-05\nCCMv4.0: UEM-06\nCCMv4.0: UEM-14\nCRI Profile v2.0: PR.AA-03\nCRI Profile v2.0: PR.AA-03.01\nCRI Profile v2.0: PR.AA-03.02\nCRI Profile v2.0: PR.AA-03.03\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-7\nSP 800-218: PO.5.2\nSP 800-53 Rev 5.1.1: AC-07\nSP 800-53 Rev 5.1.1: AC-12\nSP 800-53 Rev 5.1.1: IA-02\nSP 800-53 Rev 5.1.1: IA-03\nSP 800-53 Rev 5.1.1: IA-05\nSP 800-53 Rev 5.1.1: IA-07\nSP 800-53 Rev 5.1.1: IA-08\nSP 800-53 Rev 5.1.1: IA-09\nSP 800-53 Rev 5.1.1: IA-10\nSP 800-53 Rev 5.1.1: IA-11","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"While emergency users and groups could potentially be queried for their relationships, it is more likely that a manual review would be required to complete this process.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-04","Subcategory Description":" Identity assertions are protected, conveyed, and verified","Implementation Examples":"Ex1","Example Description":" Protect identity assertions that are used to convey authentication and user information through single sign-on systems","Informative References":"CCMv4.0: IAM-01\nCCMv4.0: IAM-03\nCCMv4.0: IAM-16\nCRI Profile v2.0: PR.AA-04\nCRI Profile v2.0: PR.AA-04.01\nSP 800-53 Rev 5.1.1: IA-13","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"SAML assertions should be able to be discoverable by different authentication and SSO providers.  However, this is likely dependent on how well the related parser has been implemented in the SIEM.  So, it may require custom queries to discover the necessary evidence.\n\nNote:  This is Entra Active DIrectory, and relies on Entra's Conditional Access functionality.  This requires an Entra ID P1 or P2 subscription for each user for data to populate.","Linked Query":false,"Vendor":"Microsoft Azure","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$user = $e.target.user.userid\n$user = \/.*\/\n$loginType = $e.extensions.auth.type\n$loginType = \"SSO\"\n$e.additional.fields[\"conditionalAccessStatus\"] = \"success\"\n\nmatch:\n    $user\n\noutcome:\n    $applications = array_distinct($e.target.application )","API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-04","Subcategory Description":" Identity assertions are protected, conveyed, and verified","Implementation Examples":"Ex2","Example Description":" Protect identity assertions that are used to convey authentication and user information between federated systems","Informative References":"CCMv4.0: IAM-01\nCCMv4.0: IAM-03\nCCMv4.0: IAM-16\nCRI Profile v2.0: PR.AA-04\nCRI Profile v2.0: PR.AA-04.01\nSP 800-53 Rev 5.1.1: IA-13","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"SAML assertions should be able to provide this information in logs.  However, this will likely take in depth research to discover the necessary logs.  Additionally, it is likely this may require a custom query to discover the evidence.\n\nNote:  This has been tested with Okta, but should be usable with any SAML IdP.","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"($e.target.application = \/SAML\/ OR \n    $e.target.resource.name = \/SAML\/ OR\n    $e.extensions.auth.type = \"SSO\" OR\n    $e.metadata.product_name = \/SSO\/ nocase )\n\n$user_id = group($e.principal.user.userid, $e.target.user.userid)\n\n$date = timestamp.get_date($e.metadata.event_timestamp.seconds)\n\n$e.target.application != \"\"\n\n$e.security_result.action = \"ALLOW\"\n\nmatch:\n    $user_id\n\noutcome:\n    $vendor = array_distinct($e.metadata.vendor_name)\n    $application = array_distinct($e.target.application)\n\norder:\n    $user_id\n\nlimit: 25","API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-04","Subcategory Description":" Identity assertions are protected, conveyed, and verified","Implementation Examples":"Ex3","Example Description":" Implement standards-based approaches for identity assertions in all contexts, and follow all guidance for the generation (e.g., data models, metadata), protection (e.g., digital signing, encryption), and verification (e.g., signature validation) of identity assertions","Informative References":"CCMv4.0: IAM-01\nCCMv4.0: IAM-03\nCCMv4.0: IAM-16\nCRI Profile v2.0: PR.AA-04\nCRI Profile v2.0: PR.AA-04.01\nSP 800-53 Rev 5.1.1: IA-13","Exportable From SIEM":"No","API":"UDM Search with YL2","Difficulty":null,"Comments":"This would need to be defined in the organizational policies and procedures.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-05","Subcategory Description":" Access permissions, entitlements, and authorizations are defined in a policy, managed, enforced, and reviewed, and incorporate the principles of least privilege and separation of duties","Implementation Examples":"Ex1","Example Description":" Review logical and physical access privileges periodically and whenever someone changes roles or leaves the organization, and promptly rescind privileges that are no longer needed","Informative References":"CCMv4.0: CCC-04\nCCMv4.0: CEK-10\nCCMv4.0: CEK-11\nCCMv4.0: CEK-12\nCCMv4.0: CEK-13\nCCMv4.0: CEK-14\nCCMv4.0: CEK-15\nCCMv4.0: CEK-16\nCCMv4.0: CEK-17\nCCMv4.0: CEK-18\nCCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: CEK-21\nCCMv4.0: IAM-01\nCCMv4.0: IAM-03\nCCMv4.0: IAM-04\nCCMv4.0: IAM-05\nCCMv4.0: IAM-06\nCCMv4.0: IAM-07\nCCMv4.0: IAM-08\nCCMv4.0: IAM-09\nCCMv4.0: IAM-10\nCCMv4.0: IAM-11\nCCMv4.0: IAM-12\nCCMv4.0: IAM-16\nCCMv4.0: IVS-03\nCCMv4.0: IVS-06\nCCMv4.0: LOG-02\nCCMv4.0: LOG-04\nCCMv4.0: LOG-09\nCCMv4.0: UEM-05\nCCMv4.0: UEM-14\nCIS Controls v8.0: 3.3\nCIS Controls v8.0: 6.8\nCRI Profile v2.0: PR.AA-05\nCRI Profile v2.0: PR.AA-05.01\nCRI Profile v2.0: PR.AA-05.02\nCRI Profile v2.0: PR.AA-05.03\nCRI Profile v2.0: PR.AA-05.04\nCSF v1.1: PR.AC-1\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-4\nSP 800-218: PO.5.2\nSP 800-218: PS.1.1\nSP 800-53 Rev 5.1.1: AC-01\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AC-03\nSP 800-53 Rev 5.1.1: AC-05\nSP 800-53 Rev 5.1.1: AC-06\nSP 800-53 Rev 5.1.1: AC-10\nSP 800-53 Rev 5.1.1: AC-16\nSP 800-53 Rev 5.1.1: AC-17\nSP 800-53 Rev 5.1.1: AC-18\nSP 800-53 Rev 5.1.1: AC-19\nSP 800-53 Rev 5.1.1: AC-24\nSP 800-53 Rev 5.1.1: IA-13","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would need to be performed manually by configuration reviews.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-05","Subcategory Description":" Access permissions, entitlements, and authorizations are defined in a policy, managed, enforced, and reviewed, and incorporate the principles of least privilege and separation of duties","Implementation Examples":"Ex2","Example Description":" Take attributes of the requester and the requested resource into account for authorization decisions (e.g., geolocation, day\/time, requester endpoint's cyber health)","Informative References":"CCMv4.0: CCC-04\nCCMv4.0: CEK-10\nCCMv4.0: CEK-11\nCCMv4.0: CEK-12\nCCMv4.0: CEK-13\nCCMv4.0: CEK-14\nCCMv4.0: CEK-15\nCCMv4.0: CEK-16\nCCMv4.0: CEK-17\nCCMv4.0: CEK-18\nCCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: CEK-21\nCCMv4.0: IAM-01\nCCMv4.0: IAM-03\nCCMv4.0: IAM-04\nCCMv4.0: IAM-05\nCCMv4.0: IAM-06\nCCMv4.0: IAM-07\nCCMv4.0: IAM-08\nCCMv4.0: IAM-09\nCCMv4.0: IAM-10\nCCMv4.0: IAM-11\nCCMv4.0: IAM-12\nCCMv4.0: IAM-16\nCCMv4.0: IVS-03\nCCMv4.0: IVS-06\nCCMv4.0: LOG-02\nCCMv4.0: LOG-04\nCCMv4.0: LOG-09\nCCMv4.0: UEM-05\nCCMv4.0: UEM-14\nCIS Controls v8.0: 3.3\nCIS Controls v8.0: 6.8\nCRI Profile v2.0: PR.AA-05\nCRI Profile v2.0: PR.AA-05.01\nCRI Profile v2.0: PR.AA-05.02\nCRI Profile v2.0: PR.AA-05.03\nCRI Profile v2.0: PR.AA-05.04\nCSF v1.1: PR.AC-1\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-4\nSP 800-218: PO.5.2\nSP 800-218: PS.1.1\nSP 800-53 Rev 5.1.1: AC-01\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AC-03\nSP 800-53 Rev 5.1.1: AC-05\nSP 800-53 Rev 5.1.1: AC-06\nSP 800-53 Rev 5.1.1: AC-10\nSP 800-53 Rev 5.1.1: AC-16\nSP 800-53 Rev 5.1.1: AC-17\nSP 800-53 Rev 5.1.1: AC-18\nSP 800-53 Rev 5.1.1: AC-19\nSP 800-53 Rev 5.1.1: AC-24\nSP 800-53 Rev 5.1.1: IA-13","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"Evidence should be available based on the type of authenication log.  For example, it would be expected to see this type of validation information in log types like Microsoft Entra Conditional Access as it tests specifically for qualifying conditions to ensure and entity may access a device or service.\n\nNote:  Query is specific to Entra ID.","Linked Query":false,"Vendor":"Microsoft Azure","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$user = $e.target.user.userid\n$user = \/.*\/\n$e.additional.fields[\"conditionalAccessStatus\"] = \"success\"\n\nmatch:\n    $user\n\noutcome:\n    $applications = array_distinct($e.target.application )\n    $country = array_distinct($e.principal.location.country_or_region)\n    $state = array_distinct($e.principal.location.state)\n    $compliant = array_distinct(if($e.principal.asset.attribute.labels[\"isCompliant\"] = \"true\", \"true\", \"false\"))\n","API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-05","Subcategory Description":" Access permissions, entitlements, and authorizations are defined in a policy, managed, enforced, and reviewed, and incorporate the principles of least privilege and separation of duties","Implementation Examples":"Ex3","Example Description":" Restrict access and privileges to the minimum necessary (e.g., zero trust architecture)","Informative References":"CCMv4.0: CCC-04\nCCMv4.0: CEK-10\nCCMv4.0: CEK-11\nCCMv4.0: CEK-12\nCCMv4.0: CEK-13\nCCMv4.0: CEK-14\nCCMv4.0: CEK-15\nCCMv4.0: CEK-16\nCCMv4.0: CEK-17\nCCMv4.0: CEK-18\nCCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: CEK-21\nCCMv4.0: IAM-01\nCCMv4.0: IAM-03\nCCMv4.0: IAM-04\nCCMv4.0: IAM-05\nCCMv4.0: IAM-06\nCCMv4.0: IAM-07\nCCMv4.0: IAM-08\nCCMv4.0: IAM-09\nCCMv4.0: IAM-10\nCCMv4.0: IAM-11\nCCMv4.0: IAM-12\nCCMv4.0: IAM-16\nCCMv4.0: IVS-03\nCCMv4.0: IVS-06\nCCMv4.0: LOG-02\nCCMv4.0: LOG-04\nCCMv4.0: LOG-09\nCCMv4.0: UEM-05\nCCMv4.0: UEM-14\nCIS Controls v8.0: 3.3\nCIS Controls v8.0: 6.8\nCRI Profile v2.0: PR.AA-05\nCRI Profile v2.0: PR.AA-05.01\nCRI Profile v2.0: PR.AA-05.02\nCRI Profile v2.0: PR.AA-05.03\nCRI Profile v2.0: PR.AA-05.04\nCSF v1.1: PR.AC-1\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-4\nSP 800-218: PO.5.2\nSP 800-218: PS.1.1\nSP 800-53 Rev 5.1.1: AC-01\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AC-03\nSP 800-53 Rev 5.1.1: AC-05\nSP 800-53 Rev 5.1.1: AC-06\nSP 800-53 Rev 5.1.1: AC-10\nSP 800-53 Rev 5.1.1: AC-16\nSP 800-53 Rev 5.1.1: AC-17\nSP 800-53 Rev 5.1.1: AC-18\nSP 800-53 Rev 5.1.1: AC-19\nSP 800-53 Rev 5.1.1: AC-24\nSP 800-53 Rev 5.1.1: IA-13","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would need to be performed via configuration review.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Identity Management, Authentication, and Access Control (PR.AA)","Category Description":" Access to physical and logical assets is limited to authorized users, services, and hardware and  managed commensurate with the assessed risk of unauthorized access","Subcategory":"PR.AA-05","Subcategory Description":" Access permissions, entitlements, and authorizations are defined in a policy, managed, enforced, and reviewed, and incorporate the principles of least privilege and separation of duties","Implementation Examples":"Ex4","Example Description":" Periodically review the privileges associated with critical business functions to confirm proper separation of duties","Informative References":"CCMv4.0: CCC-04\nCCMv4.0: CEK-10\nCCMv4.0: CEK-11\nCCMv4.0: CEK-12\nCCMv4.0: CEK-13\nCCMv4.0: CEK-14\nCCMv4.0: CEK-15\nCCMv4.0: CEK-16\nCCMv4.0: CEK-17\nCCMv4.0: CEK-18\nCCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: CEK-21\nCCMv4.0: IAM-01\nCCMv4.0: IAM-03\nCCMv4.0: IAM-04\nCCMv4.0: IAM-05\nCCMv4.0: IAM-06\nCCMv4.0: IAM-07\nCCMv4.0: IAM-08\nCCMv4.0: IAM-09\nCCMv4.0: IAM-10\nCCMv4.0: IAM-11\nCCMv4.0: IAM-12\nCCMv4.0: IAM-16\nCCMv4.0: IVS-03\nCCMv4.0: IVS-06\nCCMv4.0: LOG-02\nCCMv4.0: LOG-04\nCCMv4.0: LOG-09\nCCMv4.0: UEM-05\nCCMv4.0: UEM-14\nCIS Controls v8.0: 3.3\nCIS Controls v8.0: 6.8\nCRI Profile v2.0: PR.AA-05\nCRI Profile v2.0: PR.AA-05.01\nCRI Profile v2.0: PR.AA-05.02\nCRI Profile v2.0: PR.AA-05.03\nCRI Profile v2.0: PR.AA-05.04\nCSF v1.1: PR.AC-1\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-4\nSP 800-218: PO.5.2\nSP 800-218: PS.1.1\nSP 800-53 Rev 5.1.1: AC-01\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AC-03\nSP 800-53 Rev 5.1.1: AC-05\nSP 800-53 Rev 5.1.1: AC-06\nSP 800-53 Rev 5.1.1: AC-10\nSP 800-53 Rev 5.1.1: AC-16\nSP 800-53 Rev 5.1.1: AC-17\nSP 800-53 Rev 5.1.1: AC-18\nSP 800-53 Rev 5.1.1: AC-19\nSP 800-53 Rev 5.1.1: AC-24\nSP 800-53 Rev 5.1.1: IA-13","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would need to be performed via configuration review.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Platform Security (PR.PS)","Category Description":" The hardware, software (e.g., firmware, operating systems, applications), and services of physical and virtual platforms are managed consistent with the organization's risk strategy to protect their confidentiality, integrity, and availability","Subcategory":"PR.PS-04","Subcategory Description":" Log records are generated and made available for continuous monitoring","Implementation Examples":"Ex1","Example Description":" Configure all operating systems, applications, and services (including cloud-based services) to generate log records","Informative References":"CCMv4.0: IAM-16\nCCMv4.0: LOG-01\nCCMv4.0: LOG-02\nCCMv4.0: LOG-03\nCCMv4.0: LOG-04\nCCMv4.0: LOG-05\nCCMv4.0: LOG-07\nCCMv4.0: LOG-08\nCCMv4.0: LOG-10\nCCMv4.0: LOG-11\nCCMv4.0: LOG-12\nCCMv4.0: LOG-13\nCIS Controls v8.0: 8.2\nCRI Profile v2.0: PR.PS-04\nCRI Profile v2.0: PR.PS-04.01\nCRI Profile v2.0: PR.PS-04.02\nCRI Profile v2.0: PR.PS-04.03\nCSF v1.1: PR.PT-1\nSP 800-218: PO.3.3\nSP 800-53 Rev 5.1.1: AU-02\nSP 800-53 Rev 5.1.1: AU-03\nSP 800-53 Rev 5.1.1: AU-06\nSP 800-53 Rev 5.1.1: AU-07\nSP 800-53 Rev 5.1.1: AU-11\nSP 800-53 Rev 5.1.1: AU-12","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"Each device and the corresponding logs can be listed for reviewing against a standard inventory.  Similarly, all cloud service logs will be listed as well.  Comparison afterwards may require manual review as a spreadsheet.  \n\nNote:  This needs to be tested against a source that has NXLog sending multiple log types.","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$host = $e.principal.hostname \n$host = \/.*\/\n\nmatch:\n    $host\n\noutcome:\n    $logtypes = array_distinct($e.metadata.log_type)","API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Platform Security (PR.PS)","Category Description":" The hardware, software (e.g., firmware, operating systems, applications), and services of physical and virtual platforms are managed consistent with the organization's risk strategy to protect their confidentiality, integrity, and availability","Subcategory":"PR.PS-04","Subcategory Description":" Log records are generated and made available for continuous monitoring","Implementation Examples":"Ex2","Example Description":" Configure log generators to securely share their logs with the organization's logging infrastructure systems and services","Informative References":"CCMv4.0: IAM-16\nCCMv4.0: LOG-01\nCCMv4.0: LOG-02\nCCMv4.0: LOG-03\nCCMv4.0: LOG-04\nCCMv4.0: LOG-05\nCCMv4.0: LOG-07\nCCMv4.0: LOG-08\nCCMv4.0: LOG-10\nCCMv4.0: LOG-11\nCCMv4.0: LOG-12\nCCMv4.0: LOG-13\nCIS Controls v8.0: 8.2\nCRI Profile v2.0: PR.PS-04\nCRI Profile v2.0: PR.PS-04.01\nCRI Profile v2.0: PR.PS-04.02\nCRI Profile v2.0: PR.PS-04.03\nCSF v1.1: PR.PT-1\nSP 800-218: PO.3.3\nSP 800-53 Rev 5.1.1: AU-02\nSP 800-53 Rev 5.1.1: AU-03\nSP 800-53 Rev 5.1.1: AU-06\nSP 800-53 Rev 5.1.1: AU-07\nSP 800-53 Rev 5.1.1: AU-11\nSP 800-53 Rev 5.1.1: AU-12","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This will need to be performed via configuration review in most cases.  For example, if syslog is being sent to a SIEM Forwarder, it would be need to be confirmed on a configuration level on the Forwarder as to whether the log was sent with TLS encryption.  If it wasn't sent with TLS, were the firewall rules enabling sending syslog to the Forwarder ensuring that transmission was over a secure and controlled network.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Platform Security (PR.PS)","Category Description":" The hardware, software (e.g., firmware, operating systems, applications), and services of physical and virtual platforms are managed consistent with the organization's risk strategy to protect their confidentiality, integrity, and availability","Subcategory":"PR.PS-04","Subcategory Description":" Log records are generated and made available for continuous monitoring","Implementation Examples":"Ex3","Example Description":" Configure log generators to record the data needed by zero-trust architectures","Informative References":"CCMv4.0: IAM-16\nCCMv4.0: LOG-01\nCCMv4.0: LOG-02\nCCMv4.0: LOG-03\nCCMv4.0: LOG-04\nCCMv4.0: LOG-05\nCCMv4.0: LOG-07\nCCMv4.0: LOG-08\nCCMv4.0: LOG-10\nCCMv4.0: LOG-11\nCCMv4.0: LOG-12\nCCMv4.0: LOG-13\nCIS Controls v8.0: 8.2\nCRI Profile v2.0: PR.PS-04\nCRI Profile v2.0: PR.PS-04.01\nCRI Profile v2.0: PR.PS-04.02\nCRI Profile v2.0: PR.PS-04.03\nCSF v1.1: PR.PT-1\nSP 800-218: PO.3.3\nSP 800-53 Rev 5.1.1: AU-02\nSP 800-53 Rev 5.1.1: AU-03\nSP 800-53 Rev 5.1.1: AU-06\nSP 800-53 Rev 5.1.1: AU-07\nSP 800-53 Rev 5.1.1: AU-11\nSP 800-53 Rev 5.1.1: AU-12","Exportable From SIEM":"Yes","API":null,"Difficulty":null,"Comments":"Log evidence could be used to satisfy the requirement.  However, it would need to be a custom query based on the provider of the zero-trust technology.  The description \"zero-trust architecture\" is unfortunately too ambiguous as many different companies use it to describe many different approaches to infrastructure or user security.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Platform Security (PR.PS)","Category Description":" The hardware, software (e.g., firmware, operating systems, applications), and services of physical and virtual platforms are managed consistent with the organization's risk strategy to protect their confidentiality, integrity, and availability","Subcategory":"PR.PS-06","Subcategory Description":" Secure software development practices are integrated, and their performance is monitored throughout the software development life cycle","Implementation Examples":"Ex1","Example Description":" Protect all components of organization-developed software from tampering and unauthorized access","Informative References":"CCMv4.0: AIS-04\nCCMv4.0: AIS-06\nCCMv4.0: AIS-07\nCCMv4.0: DSP-07\nCCMv4.0: IVS-06\nCIS Controls v8.0: 16.1\nCRI Profile v2.0: PR.PS-06\nCRI Profile v2.0: PR.PS-06.01\nCRI Profile v2.0: PR.PS-06.02\nCRI Profile v2.0: PR.PS-06.03\nCRI Profile v2.0: PR.PS-06.04\nCRI Profile v2.0: PR.PS-06.05\nCRI Profile v2.0: PR.PS-06.06\nCRI Profile v2.0: PR.PS-06.07\nCRI Profile v2.0: PR.PS-06.08\nCRI Profile v2.0: PR.PS-06.09\nCRI Profile v2.0: PR.PS-06.10\nCSF v1.1: PR.IP-2\nSP 800-53 Rev 5.1.1: SA-03\nSP 800-53 Rev 5.1.1: SA-08\nSP 800-53 Rev 5.1.1: SA-10\nSP 800-53 Rev 5.1.1: SA-11\nSP 800-53 Rev 5.1.1: SA-15\nSP 800-53 Rev 5.1.1: SA-17","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would need to performed via configuration review.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Platform Security (PR.PS)","Category Description":" The hardware, software (e.g., firmware, operating systems, applications), and services of physical and virtual platforms are managed consistent with the organization's risk strategy to protect their confidentiality, integrity, and availability","Subcategory":"PR.PS-06","Subcategory Description":" Secure software development practices are integrated, and their performance is monitored throughout the software development life cycle","Implementation Examples":"Ex2","Example Description":" Secure all software produced by the organization, with minimal vulnerabilities in their releases","Informative References":"CCMv4.0: AIS-04\nCCMv4.0: AIS-06\nCCMv4.0: AIS-07\nCCMv4.0: DSP-07\nCCMv4.0: IVS-06\nCIS Controls v8.0: 16.1\nCRI Profile v2.0: PR.PS-06\nCRI Profile v2.0: PR.PS-06.01\nCRI Profile v2.0: PR.PS-06.02\nCRI Profile v2.0: PR.PS-06.03\nCRI Profile v2.0: PR.PS-06.04\nCRI Profile v2.0: PR.PS-06.05\nCRI Profile v2.0: PR.PS-06.06\nCRI Profile v2.0: PR.PS-06.07\nCRI Profile v2.0: PR.PS-06.08\nCRI Profile v2.0: PR.PS-06.09\nCRI Profile v2.0: PR.PS-06.10\nCSF v1.1: PR.IP-2\nSP 800-53 Rev 5.1.1: SA-03\nSP 800-53 Rev 5.1.1: SA-08\nSP 800-53 Rev 5.1.1: SA-10\nSP 800-53 Rev 5.1.1: SA-11\nSP 800-53 Rev 5.1.1: SA-15\nSP 800-53 Rev 5.1.1: SA-17","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This could potentially be demonstrated sending vulnerability scanning logs from a SAST\/DAST technology.  However, this would likely require substantial research.  Additionally, this is a policy question as \"minimal vulnerabilities in their releases\" is  subjective.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Platform Security (PR.PS)","Category Description":" The hardware, software (e.g., firmware, operating systems, applications), and services of physical and virtual platforms are managed consistent with the organization's risk strategy to protect their confidentiality, integrity, and availability","Subcategory":"PR.PS-06","Subcategory Description":" Secure software development practices are integrated, and their performance is monitored throughout the software development life cycle","Implementation Examples":"Ex3","Example Description":" Maintain the software used in production environments, and securely dispose of software once it is no longer needed","Informative References":"CCMv4.0: AIS-04\nCCMv4.0: AIS-06\nCCMv4.0: AIS-07\nCCMv4.0: DSP-07\nCCMv4.0: IVS-06\nCIS Controls v8.0: 16.1\nCRI Profile v2.0: PR.PS-06\nCRI Profile v2.0: PR.PS-06.01\nCRI Profile v2.0: PR.PS-06.02\nCRI Profile v2.0: PR.PS-06.03\nCRI Profile v2.0: PR.PS-06.04\nCRI Profile v2.0: PR.PS-06.05\nCRI Profile v2.0: PR.PS-06.06\nCRI Profile v2.0: PR.PS-06.07\nCRI Profile v2.0: PR.PS-06.08\nCRI Profile v2.0: PR.PS-06.09\nCRI Profile v2.0: PR.PS-06.10\nCSF v1.1: PR.IP-2\nSP 800-53 Rev 5.1.1: SA-03\nSP 800-53 Rev 5.1.1: SA-08\nSP 800-53 Rev 5.1.1: SA-10\nSP 800-53 Rev 5.1.1: SA-11\nSP 800-53 Rev 5.1.1: SA-15\nSP 800-53 Rev 5.1.1: SA-17","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would need to covered via policies and prodecures.  Operational logs (potentially tickets or custom logs) would need to be generated to prove fullment of Ex3.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Technology Infrastructure Resilience (PR.IR)","Category Description":" Security architectures are managed with the organization's risk strategy to protect asset confidentiality, integrity, and availability, and organizational resilience","Subcategory":"PR.IR-01","Subcategory Description":" Networks and environments are protected from unauthorized logical access and usage","Implementation Examples":"Ex1","Example Description":" Logically segment organization networks and cloud-based platforms according to trust boundaries and platform types (e.g., IT, IoT, OT, mobile, guests), and permit required communications only between segments","Informative References":"CCMv4.0: AIS-04\nCCMv4.0: AIS-06\nCCMv4.0: DCS-12\nCCMv4.0: DSP-10\nCCMv4.0: DSP-15\nCCMv4.0: IVS-03\nCCMv4.0: IVS-05\nCCMv4.0: IVS-06\nCCMv4.0: IVS-09\nCCMv4.0: UEM-05\nCCMv4.0: UEM-14\nCIS Controls v8.0: 3.12\nCIS Controls v8.0: 12.2\nCRI Profile v2.0: PR.IR-01\nCRI Profile v2.0: PR.IR-01.01\nCRI Profile v2.0: PR.IR-01.02\nCRI Profile v2.0: PR.IR-01.03\nCRI Profile v2.0: PR.IR-01.04\nCRI Profile v2.0: PR.IR-01.05\nCRI Profile v2.0: PR.IR-01.06\nCRI Profile v2.0: PR.IR-01.07\nCRI Profile v2.0: PR.IR-01.08\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-5\nCSF v1.1: PR.DS-7\nCSF v1.1: PR.PT-4\nSP 800-218: PO.5.1\nSP 800-53 Rev 5.1.1: AC-03\nSP 800-53 Rev 5.1.1: AC-04\nSP 800-53 Rev 5.1.1: SC-04\nSP 800-53 Rev 5.1.1: SC-05\nSP 800-53 Rev 5.1.1: SC-07","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"Firewall, netflow, and other communications between internal subnets can be demonstrated via log analysis.  However, this Example also demonstrates the need to show that only permitted communication is allowed.  This can only be done by configuration review.\n\nNote:  This rule checks to see if data is routed through a firewall.  In order for it to work, a reference list called firewall_log_types must be created.  This was tested against a list with the following firewall log types in the list:\nPAN_FIREWALL\nPAN_PANORAMA\nAWS_NETWORK_FIREWALL\nAZURE_FIREWALL\nBARRACUDA_FIREWALL\nCHECKPOINT_FIREWALL\nCISCO_ASA_FIREWALL\nCISCO_FIREPOWER_FIREWALL\nFORCEPOINT_FIREWALL\nFORTINET_FIREWALL\nPFSENSE\nRADWARE_FIREWALL\nSONIC_FIREWALL\nSOPHOS_FIREWALL\nZSCALER_FIREWALL","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$e.metadata.log_type IN %firewall_log_types \n$sourceIP = $e.principal.ip\n\n$e.principal.ip IN cidr %private_network_IP_ranges \n$e.target.ip in cidr %private_network_IP_ranges \n\n$e.security_result.action = \"ALLOW\"\n\nmatch:\n    $sourceIP\n\noutcome:\n    $destinationIP = array_distinct($e.target.ip)","API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Technology Infrastructure Resilience (PR.IR)","Category Description":" Security architectures are managed with the organization's risk strategy to protect asset confidentiality, integrity, and availability, and organizational resilience","Subcategory":"PR.IR-01","Subcategory Description":" Networks and environments are protected from unauthorized logical access and usage","Implementation Examples":"Ex2","Example Description":" Logically segment organization networks from external networks, and permit only necessary communications to enter the organization's networks from the external networks","Informative References":"CCMv4.0: AIS-04\nCCMv4.0: AIS-06\nCCMv4.0: DCS-12\nCCMv4.0: DSP-10\nCCMv4.0: DSP-15\nCCMv4.0: IVS-03\nCCMv4.0: IVS-05\nCCMv4.0: IVS-06\nCCMv4.0: IVS-09\nCCMv4.0: UEM-05\nCCMv4.0: UEM-14\nCIS Controls v8.0: 3.12\nCIS Controls v8.0: 12.2\nCRI Profile v2.0: PR.IR-01\nCRI Profile v2.0: PR.IR-01.01\nCRI Profile v2.0: PR.IR-01.02\nCRI Profile v2.0: PR.IR-01.03\nCRI Profile v2.0: PR.IR-01.04\nCRI Profile v2.0: PR.IR-01.05\nCRI Profile v2.0: PR.IR-01.06\nCRI Profile v2.0: PR.IR-01.07\nCRI Profile v2.0: PR.IR-01.08\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-5\nCSF v1.1: PR.DS-7\nCSF v1.1: PR.PT-4\nSP 800-218: PO.5.1\nSP 800-53 Rev 5.1.1: AC-03\nSP 800-53 Rev 5.1.1: AC-04\nSP 800-53 Rev 5.1.1: SC-04\nSP 800-53 Rev 5.1.1: SC-05\nSP 800-53 Rev 5.1.1: SC-07","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"Like in PR.IR-1 Ex1, firewall, netflow, and other communications between internal subnets can be demonstrated via log analysis.  However, this Example also demonstrates the need to show that only permitted communication is allowed.  This can only be done by configuration review.","Linked Query":"PR.IR-01 Ex1","Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$e.metadata.log_type IN %firewall_log_types \n$sourceIP = $e.principal.ip\n\n$e.principal.ip IN cidr %private_network_IP_ranges \n$e.target.ip in cidr %private_network_IP_ranges \n\n$e.security_result.action = \"ALLOW\"\n\nmatch:\n    $sourceIP\n\noutcome:\n    $destinationIP = array_distinct($e.target.ip)","API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Technology Infrastructure Resilience (PR.IR)","Category Description":" Security architectures are managed with the organization's risk strategy to protect asset confidentiality, integrity, and availability, and organizational resilience","Subcategory":"PR.IR-01","Subcategory Description":" Networks and environments are protected from unauthorized logical access and usage","Implementation Examples":"Ex3","Example Description":" Implement zero trust architectures to restrict network access to each resource to the minimum necessary","Informative References":"CCMv4.0: AIS-04\nCCMv4.0: AIS-06\nCCMv4.0: DCS-12\nCCMv4.0: DSP-10\nCCMv4.0: DSP-15\nCCMv4.0: IVS-03\nCCMv4.0: IVS-05\nCCMv4.0: IVS-06\nCCMv4.0: IVS-09\nCCMv4.0: UEM-05\nCCMv4.0: UEM-14\nCIS Controls v8.0: 3.12\nCIS Controls v8.0: 12.2\nCRI Profile v2.0: PR.IR-01\nCRI Profile v2.0: PR.IR-01.01\nCRI Profile v2.0: PR.IR-01.02\nCRI Profile v2.0: PR.IR-01.03\nCRI Profile v2.0: PR.IR-01.04\nCRI Profile v2.0: PR.IR-01.05\nCRI Profile v2.0: PR.IR-01.06\nCRI Profile v2.0: PR.IR-01.07\nCRI Profile v2.0: PR.IR-01.08\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-5\nCSF v1.1: PR.DS-7\nCSF v1.1: PR.PT-4\nSP 800-218: PO.5.1\nSP 800-53 Rev 5.1.1: AC-03\nSP 800-53 Rev 5.1.1: AC-04\nSP 800-53 Rev 5.1.1: SC-04\nSP 800-53 Rev 5.1.1: SC-05\nSP 800-53 Rev 5.1.1: SC-07","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would need to performed via configuration review.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Technology Infrastructure Resilience (PR.IR)","Category Description":" Security architectures are managed with the organization's risk strategy to protect asset confidentiality, integrity, and availability, and organizational resilience","Subcategory":"PR.IR-01","Subcategory Description":" Networks and environments are protected from unauthorized logical access and usage","Implementation Examples":"Ex4","Example Description":" Check the cyber health of endpoints before allowing them to access and use production resources","Informative References":"CCMv4.0: AIS-04\nCCMv4.0: AIS-06\nCCMv4.0: DCS-12\nCCMv4.0: DSP-10\nCCMv4.0: DSP-15\nCCMv4.0: IVS-03\nCCMv4.0: IVS-05\nCCMv4.0: IVS-06\nCCMv4.0: IVS-09\nCCMv4.0: UEM-05\nCCMv4.0: UEM-14\nCIS Controls v8.0: 3.12\nCIS Controls v8.0: 12.2\nCRI Profile v2.0: PR.IR-01\nCRI Profile v2.0: PR.IR-01.01\nCRI Profile v2.0: PR.IR-01.02\nCRI Profile v2.0: PR.IR-01.03\nCRI Profile v2.0: PR.IR-01.04\nCRI Profile v2.0: PR.IR-01.05\nCRI Profile v2.0: PR.IR-01.06\nCRI Profile v2.0: PR.IR-01.07\nCRI Profile v2.0: PR.IR-01.08\nCSF v1.1: PR.AC-3\nCSF v1.1: PR.AC-5\nCSF v1.1: PR.DS-7\nCSF v1.1: PR.PT-4\nSP 800-218: PO.5.1\nSP 800-53 Rev 5.1.1: AC-03\nSP 800-53 Rev 5.1.1: AC-04\nSP 800-53 Rev 5.1.1: SC-04\nSP 800-53 Rev 5.1.1: SC-05\nSP 800-53 Rev 5.1.1: SC-07","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"This requirement is very similar to PR.AA-05 Ex2, may be able to be satisfied by evidence from that Subcategory\/Example.  As such, the description is duplicated here, and this is shown as a linked query.  Should there be other queries that are more specific, they will listed.  In either case, it is recommended to used the evidence from the linked query in addition to any support queries listed here.\n\nDescription for PR.AA-05 Ex2:  Evidence should be available based on the type of authenication log.  For example, it would be expected to see this type of validation information in log types like Microsoft Entra Conditional Access as it tests specifically for qualifying conditions to ensure and entity may access a device or service.","Linked Query":"PR.AA-05 Ex2","Vendor":"Microsoft Azure","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$user = $e.target.user.userid\n$user = \/.*\/\n$e.additional.fields[\"conditionalAccessStatus\"] = \"success\"\n\nmatch:\n    $user\n\noutcome:\n    $applications = array_distinct($e.target.application )\n    $country = array_distinct($e.principal.location.country_or_region)\n    $state = array_distinct($e.principal.location.state)\n    $compliant = array_distinct(if($e.principal.asset.attribute.labels[\"isCompliant\"] = \"true\", \"true\", \"false\"))\n","API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Technology Infrastructure Resilience (PR.IR)","Category Description":" Security architectures are managed with the organization's risk strategy to protect asset confidentiality, integrity, and availability, and organizational resilience","Subcategory":"PR.IR-04","Subcategory Description":" Adequate resource capacity to ensure availability is maintained","Implementation Examples":"Ex1","Example Description":" Monitor usage of storage, power, compute, network bandwidth, and other resources","Informative References":"CCMv4.0: IVS-02\nCRI Profile v2.0: PR.IR-04\nCRI Profile v2.0: PR.IR-04.01\nCRI Profile v2.0: PR.IR-04.02\nCSF v1.1: PR.DS-4\nSP 800-53 Rev 5.1.1: CP-06\nSP 800-53 Rev 5.1.1: CP-07\nSP 800-53 Rev 5.1.1: CP-08\nSP 800-53 Rev 5.1.1: PM-03\nSP 800-53 Rev 5.1.1: PM-09","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"While usage may be imported into a SIEM, best practices for SIEM data ingestion recommends against importing operational logs.  Instead, only security relevant logs should be ingested.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"PROTECT (PR): Safeguards to manage the organization's cybersecurity risks are used","Category":"Technology Infrastructure Resilience (PR.IR)","Category Description":" Security architectures are managed with the organization's risk strategy to protect asset confidentiality, integrity, and availability, and organizational resilience","Subcategory":"PR.IR-04","Subcategory Description":" Adequate resource capacity to ensure availability is maintained","Implementation Examples":"Ex2","Example Description":" Forecast future needs, and scale resources accordingly","Informative References":"CCMv4.0: IVS-02\nCRI Profile v2.0: PR.IR-04\nCRI Profile v2.0: PR.IR-04.01\nCRI Profile v2.0: PR.IR-04.02\nCSF v1.1: PR.DS-4\nSP 800-53 Rev 5.1.1: CP-06\nSP 800-53 Rev 5.1.1: CP-07\nSP 800-53 Rev 5.1.1: CP-08\nSP 800-53 Rev 5.1.1: PM-03\nSP 800-53 Rev 5.1.1: PM-09","Exportable From SIEM":"Yes","API":"Dashboard Export API ","Difficulty":"Done","Comments":"Log ingestion should be monitored for all log ingestion types.  This will enable security departments to forecast future budgetary needs for data ingestion.  Additionally, a drop off in events or a increase in events can indicate log sources dropping off or additional resources being added to the environment, respectively.  Both cases should be investigated to ensure it is expected.\n\nDashboard:  R52 PR.IR-04 Ex2 - Forecast Future Needs","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":"R52 PR.IR-04 Ex2 - Forecast Future Needs","Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-01","Subcategory Description":" Networks and network services are monitored to find potentially adverse events","Implementation Examples":"Ex1","Example Description":" Monitor DNS, BGP, and other network services for adverse events","Informative References":"CCMv4.0: IVS-03\nCCMv4.0: IVS-09\nCCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: TVM-02\nCCMv4.0: TVM-10\nCCMv4.0: UEM-10\nCIS Controls v8.0: 13.1\nCRI Profile v2.0: DE.CM-01\nCRI Profile v2.0: DE.CM-01.01\nCRI Profile v2.0: DE.CM-01.02\nCRI Profile v2.0: DE.CM-01.03\nCRI Profile v2.0: DE.CM-01.04\nCRI Profile v2.0: DE.CM-01.05\nCRI Profile v2.0: DE.CM-01.06\nCSF v1.1: DE.CM-1\nCSF v1.1: DE.CM-4\nCSF v1.1: DE.CM-5\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-03\nSP 800-53 Rev 5.1.1: SC-05\nSP 800-53 Rev 5.1.1: SC-07\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"Dashboard Export API","Difficulty":"In progress","Comments":"DNS, BGP, and other network events should be ingested into the SIEM for security event analysis and correlation.  \n\nThe associated query demonstrates that DNS  events are being ingested into the SIEM.  Other network services could use a similar query, but would require it to be custom created.\n\nDashboard:  R53 DE.CM-01 Ex1 - Monitor Network Services","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":"R53 DE.CM-01 Ex1 - Monitor Network Services","Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-01","Subcategory Description":" Networks and network services are monitored to find potentially adverse events","Implementation Examples":"Ex2","Example Description":" Monitor wired and wireless networks for connections from unauthorized endpoints","Informative References":"CCMv4.0: IVS-03\nCCMv4.0: IVS-09\nCCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: TVM-02\nCCMv4.0: TVM-10\nCCMv4.0: UEM-10\nCIS Controls v8.0: 13.1\nCRI Profile v2.0: DE.CM-01\nCRI Profile v2.0: DE.CM-01.01\nCRI Profile v2.0: DE.CM-01.02\nCRI Profile v2.0: DE.CM-01.03\nCRI Profile v2.0: DE.CM-01.04\nCRI Profile v2.0: DE.CM-01.05\nCRI Profile v2.0: DE.CM-01.06\nCSF v1.1: DE.CM-1\nCSF v1.1: DE.CM-4\nCSF v1.1: DE.CM-5\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-03\nSP 800-53 Rev 5.1.1: SC-05\nSP 800-53 Rev 5.1.1: SC-07\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Unverified","Comments":"By ingesting wired network logs and wireless network logs it is possible to discern these types of events.  However, it is likely these events are vendor specific, and likely not translated to specific UDM fields.  This would require research and custom queries to be successful.\n\nNote:  This is a Cisco Meraki specific query. This query is based on the elements in the SecOps parser for authorization.  However, as Meraki also makes firewalls, this could also find firewall events (not just wired or wireless) events that resulted in blocked action.  \n\nWhile syntactically correct, this query has not been tested.  This would need to be tested against a Meraki switch\/wifi infrastructure.","Linked Query":false,"Vendor":"Cisco Meraki","Query Version":"Alpha","Dashboard Name":null,"Pretty Print Queries":"$hostname = $e.principal.hostname\n$hostname = \/.*\/\n$hostname != \"\"\n\n$e.metadata.log_type = \"CISCO_MERAKI\"\n$e.security_result.action = \"BLOCK\"\n\nmatch:\n    $hostname\n\noutcome:\n    $block_count = count($e.metadata.id)\n\norder:\n    $hostname","API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-01","Subcategory Description":" Networks and network services are monitored to find potentially adverse events","Implementation Examples":"Ex3","Example Description":" Monitor facilities for unauthorized or rogue wireless networks","Informative References":"CCMv4.0: IVS-03\nCCMv4.0: IVS-09\nCCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: TVM-02\nCCMv4.0: TVM-10\nCCMv4.0: UEM-10\nCIS Controls v8.0: 13.1\nCRI Profile v2.0: DE.CM-01\nCRI Profile v2.0: DE.CM-01.01\nCRI Profile v2.0: DE.CM-01.02\nCRI Profile v2.0: DE.CM-01.03\nCRI Profile v2.0: DE.CM-01.04\nCRI Profile v2.0: DE.CM-01.05\nCRI Profile v2.0: DE.CM-01.06\nCSF v1.1: DE.CM-1\nCSF v1.1: DE.CM-4\nCSF v1.1: DE.CM-5\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-03\nSP 800-53 Rev 5.1.1: SC-05\nSP 800-53 Rev 5.1.1: SC-07\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"By ingesting wireless network logs it is possible to discern these types of events.  However, it is likely these events are vendor specific, and likely not translated to specific UDM fields.  This would require research and custom queries to be successful.\n\nThis is a Cisco Meraki specific query.\n\nThe current query lists the full security_result.description.  Theoretically, re.capture should enable the ability to get rid of everything except the actual SSID.  However, it ends up leaving the SSID column blank with only the event type listed.\n\nHere is the re.capture that should be in the place of line 1:  $ssid = re.capture($e.security_result.description, \/.*ssid: (.*)\/)\n\nNOTE:  BE SURE TO GET RID OF \"CONTAINING_DEVICE\" IN THE FINAL VERSION OF THE QUERY.","Linked Query":false,"Vendor":"Cisco Meraki","Query Version":"Beta","Dashboard Name":null,"Pretty Print Queries":"$ssid = $e.security_result.description\n\n$e.metadata.log_type = \"CISCO_MERAKI\"\n$e.metadata.product_event_type = \"airmarshal_events\"\n$e.security_result.summary = \/rogue_ssid_detected|containing_device|ssid_spoofing_detected\/\n\nmatch:\n    $ssid\n\noutcome:\n    $violation_type = array_distinct($e.security_result.summary)\n    $last_seen = timestamp.get_date(max($e.metadata.event_timestamp.seconds))","API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-01","Subcategory Description":" Networks and network services are monitored to find potentially adverse events","Implementation Examples":"Ex4","Example Description":" Compare actual network flows against baselines to detect deviations","Informative References":"CCMv4.0: IVS-03\nCCMv4.0: IVS-09\nCCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: TVM-02\nCCMv4.0: TVM-10\nCCMv4.0: UEM-10\nCIS Controls v8.0: 13.1\nCRI Profile v2.0: DE.CM-01\nCRI Profile v2.0: DE.CM-01.01\nCRI Profile v2.0: DE.CM-01.02\nCRI Profile v2.0: DE.CM-01.03\nCRI Profile v2.0: DE.CM-01.04\nCRI Profile v2.0: DE.CM-01.05\nCRI Profile v2.0: DE.CM-01.06\nCSF v1.1: DE.CM-1\nCSF v1.1: DE.CM-4\nCSF v1.1: DE.CM-5\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-03\nSP 800-53 Rev 5.1.1: SC-05\nSP 800-53 Rev 5.1.1: SC-07\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"Dashboard Export API","Difficulty":"In progress","Comments":"The most common way this is performed is by ingesting Netflow for on premise networks.  However, it can also be obtained via VPC flow logs.  Log analysis would be rudimentary, but is expected in the future Google SecOps will have machine learning capabilities for flow analysis.\n\nDashboard:  R56 DE.CM-01 Ex4 - Sent Bytes over Time\n\nNote:  Can't get Looker to display both sent and received bytes at the same time.","Linked Query":false,"Vendor":"Agnostic","Query Version":"Beta","Dashboard Name":"R56 DE.CM-01 Ex4 - Sent Bytes over Time","Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-01","Subcategory Description":" Networks and network services are monitored to find potentially adverse events","Implementation Examples":"Ex5","Example Description":" Monitor network communications to identify changes in security postures for zero trust purposes","Informative References":"CCMv4.0: IVS-03\nCCMv4.0: IVS-09\nCCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: TVM-02\nCCMv4.0: TVM-10\nCCMv4.0: UEM-10\nCIS Controls v8.0: 13.1\nCRI Profile v2.0: DE.CM-01\nCRI Profile v2.0: DE.CM-01.01\nCRI Profile v2.0: DE.CM-01.02\nCRI Profile v2.0: DE.CM-01.03\nCRI Profile v2.0: DE.CM-01.04\nCRI Profile v2.0: DE.CM-01.05\nCRI Profile v2.0: DE.CM-01.06\nCSF v1.1: DE.CM-1\nCSF v1.1: DE.CM-4\nCSF v1.1: DE.CM-5\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-03\nSP 800-53 Rev 5.1.1: SC-05\nSP 800-53 Rev 5.1.1: SC-07\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"This would require creating custom queries for the specific zero trust vendor to identify specific properties that may have changed.","Linked Query":false,"Vendor":"CustomRequired","Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-03","Subcategory Description":" Personnel activity and technology usage are monitored to find potentially adverse events","Implementation Examples":"Ex1","Example Description":" Use behavior analytics software to detect anomalous user activity to mitigate insider threats","Informative References":"CCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: TVM-10\nCIS Controls v8.0: 10.7\nCRI Profile v2.0: DE.CM-03\nCRI Profile v2.0: DE.CM-03.01\nCRI Profile v2.0: DE.CM-03.02\nCRI Profile v2.0: DE.CM-03.03\nCSF v1.1: DE.CM-3\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: AU-13\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-10\nSP 800-53 Rev 5.1.1: CM-11","Exportable From SIEM":"Yes","API":"Unknown","Difficulty":null,"Comments":"It is possible to create alerts on behavior analytics and UEBA, it would require further research to determine the correct API and quiries to retreive such data.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-03","Subcategory Description":" Personnel activity and technology usage are monitored to find potentially adverse events","Implementation Examples":"Ex2","Example Description":" Monitor logs from logical access control systems to find unusual access patterns and failed access attempts","Informative References":"CCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: TVM-10\nCIS Controls v8.0: 10.7\nCRI Profile v2.0: DE.CM-03\nCRI Profile v2.0: DE.CM-03.01\nCRI Profile v2.0: DE.CM-03.02\nCRI Profile v2.0: DE.CM-03.03\nCSF v1.1: DE.CM-3\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: AU-13\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-10\nSP 800-53 Rev 5.1.1: CM-11","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"This can be determined via failed logins to specific resources.   However, this is a very general Example, and could apply to many different types of resources.  For example:  access attempts to a shared drive, access attempts to a shared folder or file, access to RDP, access to SSH, and many other things.  \n\nNote:   The following rule is a modified version of the Google Curated set of rules for detection to support aggregate queries.  Quer from Google:   multiple_authentication_failures_for_single_user","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$e.metadata.event_type = \"USER_LOGIN\"\n$e.security_result.action = \"BLOCK\"\n$e.principal.hostname != \"\"\n$e.principal.ip = $ip\n$e.target.user.userid != \"\"\n$e.target.user.userid = $target_user\n$e.target.user.userid != \"Not Available\" \n$e.extensions.auth.mechanism != \"OTP\" and $e.target.user.user_authentication_status != \"SUSPENDED\" and $e.target.user.user_authentication_status != \"NO_ACTIVE_CREDENTIALS\"\nnot (re.regex($e.target.user.userid, `.*\\$`))\nnot $e.security_result.description in %whitelisted_login_failure_reason_codes \/\/This is to eliminate noise cases like user login attempt with expired login credentials, user is presented MFA, username does not exist.\n        \nmatch:\n    $target_user over 1h\n\noutcome:\n    $hostname = array_distinct($e.principal.hostname)\n    $ip_address = array_distinct($ip)\n    $anomalous = if(sum(if($e.security_result.action = \"BLOCK\", 1, 0))>50, \"Yes\", \"No\")\n    $anomalous_count = sum(if($e.security_result.action = \"BLOCK\", 1, 0))\n\norder:\n    $anomalous_count desc","API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-03","Subcategory Description":" Personnel activity and technology usage are monitored to find potentially adverse events","Implementation Examples":"Ex3","Example Description":" Continuously monitor deception technology, including user accounts, for any usage","Informative References":"CCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: TVM-10\nCIS Controls v8.0: 10.7\nCRI Profile v2.0: DE.CM-03\nCRI Profile v2.0: DE.CM-03.01\nCRI Profile v2.0: DE.CM-03.02\nCRI Profile v2.0: DE.CM-03.03\nCSF v1.1: DE.CM-3\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-02\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: AU-13\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-10\nSP 800-53 Rev 5.1.1: CM-11","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"Deception technologies are vendor specific and require specific queries.  The most common deception technology is Thinkst Canary.\n\nA subscription to Thinkst is required, but unavailable for a UDM.  ","Linked Query":false,"Vendor":"CustomRequired","Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-06","Subcategory Description":" External service provider activities and services are monitored to find potentially adverse events","Implementation Examples":"Ex1","Example Description":" Monitor remote and onsite administration and maintenance activities that external providers perform on organizational systems","Informative References":"CCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: TVM-10\nCIS Controls v8.0: 15.2\nCIS Controls v8.0: 15.6\nCRI Profile v2.0: DE.CM-06\nCRI Profile v2.0: DE.CM-06.01\nCRI Profile v2.0: DE.CM-06.02\nCSF v1.1: DE.CM-6\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: PS-07\nSP 800-53 Rev 5.1.1: SA-04\nSP 800-53 Rev 5.1.1: SA-09\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"This query could be pulled from any type of query that demonstrates adverse indicators of compromise on a system.  For example, a lolbins (living off the land binary) action that is potentially malicious.\n\nThis query specifically is looking for a high number of authentication failures in a namespace.  \n\nNote:  It is required that the on premise assets use a namespace that is different from the cloud assets.  The namespaces for the on premise assets much be in a list named \"on_premise_namespaces\"","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$my_namespace = group($e.target.namespace, $e.principal.namespace)\n$my_namespace in %on_premise_namespaces \n\n$e.metadata.event_type = \"USER_LOGIN\"\n$e.security_result.action = \"BLOCK\"\n$e.principal.ip = $ip\n$e.target.user.userid != \"\"\n$e.target.hostname != \"\"\n$e.target.user.userid = $target_user\n$e.target.user.userid != \"Not Available\" \n$e.extensions.auth.mechanism != \"OTP\" and $e.target.user.user_authentication_status != \"SUSPENDED\" and $e.target.user.user_authentication_status != \"NO_ACTIVE_CREDENTIALS\"\nnot (re.regex($e.target.user.userid, `.*\\$`))\nnot $e.security_result.description in %whitelisted_login_failure_reason_codes \/\/This is to eliminate noise cases like user login attempt with expired login credentials, user is presented MFA, username does not exist.\n        \nmatch:\n    $target_user over 1h\n\noutcome:\n    $product = array_distinct($e.metadata.product_name)\n    $target_hostname = array_distinct($e.target.hostname)\n    $ip_address = array_distinct($ip)\n    $anomalous = if(sum(if($e.security_result.action = \"BLOCK\", 1, 0))>2, \"Yes\", \"No\")\n    $anomalous_count = sum(if($e.security_result.action = \"BLOCK\", 1, 0))\n    $first_seen = timestamp.get_date(min($e.metadata.event_timestamp.seconds))\n    $last_seen = timestamp.get_date(max($e.metadata.event_timestamp.seconds))\n\norder:\n    $anomalous_count desc\n\nlimit:\n    100","API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-06","Subcategory Description":" External service provider activities and services are monitored to find potentially adverse events","Implementation Examples":"Ex2","Example Description":" Monitor activity from cloud-based services, internet service providers, and other service providers for deviations from expected behavior","Informative References":"CCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: TVM-10\nCIS Controls v8.0: 15.2\nCIS Controls v8.0: 15.6\nCRI Profile v2.0: DE.CM-06\nCRI Profile v2.0: DE.CM-06.01\nCRI Profile v2.0: DE.CM-06.02\nCSF v1.1: DE.CM-6\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: PS-07\nSP 800-53 Rev 5.1.1: SA-04\nSP 800-53 Rev 5.1.1: SA-09\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"This could be any query that demonostrates that the SIEM will create alerts for indicators of compromise from cloud provider logs.\n\nThe following shows anomalously high number of failed logins within a single hour.  More than 2 failed attempts is considered high.\n\nThe following query should work on AWS, Azure, Office365, or Google.  However, it has only been tested with Azure.","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"($e.about.asset.attribute.cloud.environment = \"AMAZON_WEB_SERVICES\" or\n    $e.about.asset.attribute.cloud.environment = \"GOOGLE_CLOUD_PLATFORM\" or\n    $e.about.asset.attribute.cloud.environment = \"MICROSOFT_AZURE\" or\n    $e.about.asset.attribute.cloud.environment = \"UNSPECIFIED_CLOUD_ENVIRONMENT\")\n\n$e.metadata.event_type = \"USER_LOGIN\"\n$e.security_result.action = \"BLOCK\"\n$e.principal.ip = $ip\n$e.target.user.userid != \"\"\n$e.target.hostname != \"\"\n$e.target.user.userid = $target_user\n$e.target.user.userid != \"Not Available\" \n$e.extensions.auth.mechanism != \"OTP\" and $e.target.user.user_authentication_status != \"SUSPENDED\" and $e.target.user.user_authentication_status != \"NO_ACTIVE_CREDENTIALS\"\nnot (re.regex($e.target.user.userid, `.*\\$`))\nnot $e.security_result.description in %whitelisted_login_failure_reason_codes \/\/This is to eliminate noise cases like user login attempt with expired login credentials, user is presented MFA, username does not exist.\n        \nmatch:\n    $target_user over 1h\n\noutcome:\n    $product = array_distinct($e.metadata.product_name)\n    $target_hostname = array_distinct($e.target.hostname)\n    $ip_address = array_distinct($ip)\n    $anomalous = if(sum(if($e.security_result.action = \"BLOCK\", 1, 0))>2, \"Yes\", \"No\")\n    $anomalous_count = sum(if($e.security_result.action = \"BLOCK\", 1, 0))\n    $first_seen = timestamp.get_date(min($e.metadata.event_timestamp.seconds))\n    $last_seen = timestamp.get_date(max($e.metadata.event_timestamp.seconds))\n\norder:\n    $anomalous_count desc\n\nlimit:\n    100","API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-09","Subcategory Description":" Computing hardware and software, runtime environments, and their data are monitored to find potentially adverse events","Implementation Examples":"Ex1","Example Description":" Monitor email, web, file sharing, collaboration services, and other common attack vectors to detect malware, phishing, data leaks and exfiltration, and other adverse events","Informative References":"CCMv4.0: CCC-07\nCCMv4.0: IVS-06\nCCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: LOG-10\nCCMv4.0: LOG-11\nCCMv4.0: TVM-02\nCCMv4.0: TVM-10\nCCMv4.0: UEM-09\nCCMv4.0: UEM-10\nCCMv4.0: UEM-11\nCIS Controls v8.0: 10.1\nCRI Profile v2.0: DE.CM-09\nCRI Profile v2.0: DE.CM-09.01\nCRI Profile v2.0: DE.CM-09.02\nCRI Profile v2.0: DE.CM-09.03\nCSF v1.1: PR.DS-6\nCSF v1.1: PR.DS-8\nCSF v1.1: DE.CM-4\nCSF v1.1: DE.CM-5\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-04\nSP 800-53 Rev 5.1.1: AC-09\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-03\nSP 800-53 Rev 5.1.1: CM-06\nSP 800-53 Rev 5.1.1: CM-10\nSP 800-53 Rev 5.1.1: CM-11\nSP 800-53 Rev 5.1.1: SC-34\nSP 800-53 Rev 5.1.1: SC-35\nSP 800-53 Rev 5.1.1: SI-04\nSP 800-53 Rev 5.1.1: SI-07","Exportable From SIEM":"Yes","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"This query would involve pulling an alerts for something like Office365 Sharepoint activity when a malicious file is detected.  Similarly, the query could be based on Office365 phishing alerts.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-09","Subcategory Description":" Computing hardware and software, runtime environments, and their data are monitored to find potentially adverse events","Implementation Examples":"Ex2","Example Description":" Monitor authentication attempts to identify attacks against credentials and unauthorized credential reuse","Informative References":"CCMv4.0: CCC-07\nCCMv4.0: IVS-06\nCCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: LOG-10\nCCMv4.0: LOG-11\nCCMv4.0: TVM-02\nCCMv4.0: TVM-10\nCCMv4.0: UEM-09\nCCMv4.0: UEM-10\nCCMv4.0: UEM-11\nCIS Controls v8.0: 10.1\nCRI Profile v2.0: DE.CM-09\nCRI Profile v2.0: DE.CM-09.01\nCRI Profile v2.0: DE.CM-09.02\nCRI Profile v2.0: DE.CM-09.03\nCSF v1.1: PR.DS-6\nCSF v1.1: PR.DS-8\nCSF v1.1: DE.CM-4\nCSF v1.1: DE.CM-5\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-04\nSP 800-53 Rev 5.1.1: AC-09\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-03\nSP 800-53 Rev 5.1.1: CM-06\nSP 800-53 Rev 5.1.1: CM-10\nSP 800-53 Rev 5.1.1: CM-11\nSP 800-53 Rev 5.1.1: SC-34\nSP 800-53 Rev 5.1.1: SC-35\nSP 800-53 Rev 5.1.1: SI-04\nSP 800-53 Rev 5.1.1: SI-07","Exportable From SIEM":"Yes","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"Credential reuse can be difficult to prove as malicious.  However,  a more common example would be an impossible travel alerts.  Impossible travel is when a user logs into a device from one IP and then from another IP within a short period of time.  Using geolocation, it is possible to determine that they could not have reasonably traveled from geoIP location 1 to geoIP location 2.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-09","Subcategory Description":" Computing hardware and software, runtime environments, and their data are monitored to find potentially adverse events","Implementation Examples":"Ex3","Example Description":" Monitor software configurations for deviations from security baselines","Informative References":"CCMv4.0: CCC-07\nCCMv4.0: IVS-06\nCCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: LOG-10\nCCMv4.0: LOG-11\nCCMv4.0: TVM-02\nCCMv4.0: TVM-10\nCCMv4.0: UEM-09\nCCMv4.0: UEM-10\nCCMv4.0: UEM-11\nCIS Controls v8.0: 10.1\nCRI Profile v2.0: DE.CM-09\nCRI Profile v2.0: DE.CM-09.01\nCRI Profile v2.0: DE.CM-09.02\nCRI Profile v2.0: DE.CM-09.03\nCSF v1.1: PR.DS-6\nCSF v1.1: PR.DS-8\nCSF v1.1: DE.CM-4\nCSF v1.1: DE.CM-5\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-04\nSP 800-53 Rev 5.1.1: AC-09\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-03\nSP 800-53 Rev 5.1.1: CM-06\nSP 800-53 Rev 5.1.1: CM-10\nSP 800-53 Rev 5.1.1: CM-11\nSP 800-53 Rev 5.1.1: SC-34\nSP 800-53 Rev 5.1.1: SC-35\nSP 800-53 Rev 5.1.1: SI-04\nSP 800-53 Rev 5.1.1: SI-07","Exportable From SIEM":"Yes","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"This Example could cover a broad scope of possibilities.  However, the most common way to provide that software configurations have not changed (especially, with the PCI-DSS framework) is to use file integrity monitoring (FIM).  The query will demonstrate a FIM-based alert.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-09","Subcategory Description":" Computing hardware and software, runtime environments, and their data are monitored to find potentially adverse events","Implementation Examples":"Ex4","Example Description":" Monitor hardware and software for signs of tampering","Informative References":"CCMv4.0: CCC-07\nCCMv4.0: IVS-06\nCCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: LOG-10\nCCMv4.0: LOG-11\nCCMv4.0: TVM-02\nCCMv4.0: TVM-10\nCCMv4.0: UEM-09\nCCMv4.0: UEM-10\nCCMv4.0: UEM-11\nCIS Controls v8.0: 10.1\nCRI Profile v2.0: DE.CM-09\nCRI Profile v2.0: DE.CM-09.01\nCRI Profile v2.0: DE.CM-09.02\nCRI Profile v2.0: DE.CM-09.03\nCSF v1.1: PR.DS-6\nCSF v1.1: PR.DS-8\nCSF v1.1: DE.CM-4\nCSF v1.1: DE.CM-5\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-04\nSP 800-53 Rev 5.1.1: AC-09\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-03\nSP 800-53 Rev 5.1.1: CM-06\nSP 800-53 Rev 5.1.1: CM-10\nSP 800-53 Rev 5.1.1: CM-11\nSP 800-53 Rev 5.1.1: SC-34\nSP 800-53 Rev 5.1.1: SC-35\nSP 800-53 Rev 5.1.1: SI-04\nSP 800-53 Rev 5.1.1: SI-07","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"While it is possible to ingest hardware alarm events to alert on tampering, this would require custom queries based on the make and model of the technology to be successful.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Continuous Monitoring (DE.CM)","Category Description":" Assets are monitored to find anomalies, indicators of compromise, and other potentially adverse events","Subcategory":"DE.CM-09","Subcategory Description":" Computing hardware and software, runtime environments, and their data are monitored to find potentially adverse events","Implementation Examples":"Ex5","Example Description":" Use technologies with a presence on endpoints to detect cyber health issues (e.g., missing patches, malware infections, unauthorized software), and redirect the endpoints to a remediation environment before access is authorized","Informative References":"CCMv4.0: CCC-07\nCCMv4.0: IVS-06\nCCMv4.0: LOG-01\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-08\nCCMv4.0: LOG-10\nCCMv4.0: LOG-11\nCCMv4.0: TVM-02\nCCMv4.0: TVM-10\nCCMv4.0: UEM-09\nCCMv4.0: UEM-10\nCCMv4.0: UEM-11\nCIS Controls v8.0: 10.1\nCRI Profile v2.0: DE.CM-09\nCRI Profile v2.0: DE.CM-09.01\nCRI Profile v2.0: DE.CM-09.02\nCRI Profile v2.0: DE.CM-09.03\nCSF v1.1: PR.DS-6\nCSF v1.1: PR.DS-8\nCSF v1.1: DE.CM-4\nCSF v1.1: DE.CM-5\nCSF v1.1: DE.CM-7\nSP 800-53 Rev 5.1.1: AC-04\nSP 800-53 Rev 5.1.1: AC-09\nSP 800-53 Rev 5.1.1: AU-12\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: CM-03\nSP 800-53 Rev 5.1.1: CM-06\nSP 800-53 Rev 5.1.1: CM-10\nSP 800-53 Rev 5.1.1: CM-11\nSP 800-53 Rev 5.1.1: SC-34\nSP 800-53 Rev 5.1.1: SC-35\nSP 800-53 Rev 5.1.1: SI-04\nSP 800-53 Rev 5.1.1: SI-07","Exportable From SIEM":"Yes","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"The ability to redirect endpoints to a remediation environment (or depending on the manufacturer, change their VLAN to a remedation environment) is based on the make and model of the technology being used.  This would require custom queries specific to the technology that has been implemented.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Adverse Event Analysis (DE.AE)","Category Description":" Anomalies, indicators of compromise, and other potentially adverse events are analyzed to characterize the events and detect cybersecurity incidents","Subcategory":"DE.AE-02","Subcategory Description":" Potentially adverse events are analyzed to better understand associated activities","Implementation Examples":"Ex1","Example Description":" Use security information and event management (SIEM) or other tools to continuously monitor log events for known malicious and suspicious activity","Informative References":"CCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: SEF-05\nCCMv4.0: SEF-06\nCCMv4.0: UEM-09\nCIS Controls v8.0: 8.11\nCRI Profile v2.0: DE.AE-02\nCRI Profile v2.0: DE.AE-02.01\nCRI Profile v2.0: DE.AE-02.02\nCSF v1.1: DE.AE-2\nSP 800-53 Rev 5.1.1: AU-06\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"Generation of any alert events proves that a SIEM technology is actively monitoring the environment, or at least a set of log sources for an environment.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Adverse Event Analysis (DE.AE)","Category Description":" Anomalies, indicators of compromise, and other potentially adverse events are analyzed to characterize the events and detect cybersecurity incidents","Subcategory":"DE.AE-02","Subcategory Description":" Potentially adverse events are analyzed to better understand associated activities","Implementation Examples":"Ex2","Example Description":" Utilize up-to-date cyber threat intelligence in log analysis tools to improve detection accuracy and characterize threat actors, their methods, and indicators of compromise","Informative References":"CCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: SEF-05\nCCMv4.0: SEF-06\nCCMv4.0: UEM-09\nCIS Controls v8.0: 8.11\nCRI Profile v2.0: DE.AE-02\nCRI Profile v2.0: DE.AE-02.01\nCRI Profile v2.0: DE.AE-02.02\nCSF v1.1: DE.AE-2\nSP 800-53 Rev 5.1.1: AU-06\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"Every SIEM technology utilizes some sort of threat intelligence source for indicators of compromise.  It will take research to determine how to demonstrate ingested IOCs and update to date threat intelligence (if it is possible at all).","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Adverse Event Analysis (DE.AE)","Category Description":" Anomalies, indicators of compromise, and other potentially adverse events are analyzed to characterize the events and detect cybersecurity incidents","Subcategory":"DE.AE-02","Subcategory Description":" Potentially adverse events are analyzed to better understand associated activities","Implementation Examples":"Ex3","Example Description":" Regularly conduct manual reviews of log events for technologies that cannot be sufficiently monitored through automation","Informative References":"CCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: SEF-05\nCCMv4.0: SEF-06\nCCMv4.0: UEM-09\nCIS Controls v8.0: 8.11\nCRI Profile v2.0: DE.AE-02\nCRI Profile v2.0: DE.AE-02.01\nCRI Profile v2.0: DE.AE-02.02\nCSF v1.1: DE.AE-2\nSP 800-53 Rev 5.1.1: AU-06\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would need to be performed manually on log sources which are not ingestible into a SIEM.  An example would be keycard logs for an office space.  Many keycard systems cannot export their logs via syslog or other common medium.  The logs must be reviewed manually for adverse activity.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Adverse Event Analysis (DE.AE)","Category Description":" Anomalies, indicators of compromise, and other potentially adverse events are analyzed to characterize the events and detect cybersecurity incidents","Subcategory":"DE.AE-02","Subcategory Description":" Potentially adverse events are analyzed to better understand associated activities","Implementation Examples":"Ex4","Example Description":" Use log analysis tools to generate reports on their findings","Informative References":"CCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: SEF-05\nCCMv4.0: SEF-06\nCCMv4.0: UEM-09\nCIS Controls v8.0: 8.11\nCRI Profile v2.0: DE.AE-02\nCRI Profile v2.0: DE.AE-02.01\nCRI Profile v2.0: DE.AE-02.02\nCSF v1.1: DE.AE-2\nSP 800-53 Rev 5.1.1: AU-06\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"The alerts that are genereated for DE.AE-02 Ex 1 sufficiently demonstrate reporting from log analysis tool","Linked Query":false,"Vendor":null,"Query Version":"DE.AE-02 Ex1","Dashboard Name":null,"Pretty Print Queries":0,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Adverse Event Analysis (DE.AE)","Category Description":" Anomalies, indicators of compromise, and other potentially adverse events are analyzed to characterize the events and detect cybersecurity incidents","Subcategory":"DE.AE-03","Subcategory Description":" Information is correlated from multiple sources","Implementation Examples":"Ex1","Example Description":" Constantly transfer log data generated by other sources to a relatively small number of log servers","Informative References":"CCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: SEF-05\nCRI Profile v2.0: DE.AE-03\nCRI Profile v2.0: DE.AE-03.01\nCRI Profile v2.0: DE.AE-03.02\nCSF v1.1: DE.AE-3\nSP 800-53 Rev 5.1.1: AU-06\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: PM-16\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: IR-05\nSP 800-53 Rev 5.1.1: IR-08\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"The UDM query will show multiple servers and the quantity of log events that they have been sent over a period of time.\n\nNote:  This is an indiscriminant query that will find all log sources, the number of distinct \"principal.hostnames\" sending logs, and the total number of events sent by that log source type.","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$log_types = $e.metadata.log_type\n$log_types = \/.*\/\n\nmatch:\n    $log_types\n\noutcome:\n    $count_principal_hosts = count_distinct($e.principal.hostname)\n    $events_count = count_distinct($e.metadata.id)\n\norder:\n    $log_types","API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Adverse Event Analysis (DE.AE)","Category Description":" Anomalies, indicators of compromise, and other potentially adverse events are analyzed to characterize the events and detect cybersecurity incidents","Subcategory":"DE.AE-03","Subcategory Description":" Information is correlated from multiple sources","Implementation Examples":"Ex2","Example Description":" Use event correlation technology (e.g., SIEM) to collect information captured by multiple sources","Informative References":"CCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: SEF-05\nCRI Profile v2.0: DE.AE-03\nCRI Profile v2.0: DE.AE-03.01\nCRI Profile v2.0: DE.AE-03.02\nCSF v1.1: DE.AE-3\nSP 800-53 Rev 5.1.1: AU-06\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: PM-16\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: IR-05\nSP 800-53 Rev 5.1.1: IR-08\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"In progress","Comments":"Event correlation is at the heart of any SIEM technology.  It will require research to demonstrate that correlation is occuring.  Perhaps showing log failures\/success to trigger an alert sufficiently demonstrates correlation.","Linked Query":false,"Vendor":"Agnostic","Query Version":null,"Dashboard Name":null,"Pretty Print Queries":"$correlation_description = $e.security_result.description\n$correlation_description = \/.*\/\n$severity = $e.security_result.severity \n\n$e.security_result.alert_state = \"ALERTING\"\n\nmatch:\n    $correlation_description\n\noutcome:\n    $log_type = array_distinct($e.metadata.log_type)\n    $high_or_critical = if($severity = \"HIGH\", \"Yes\", \"No\")\n    $criticality = array_distinct($severity )","API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Adverse Event Analysis (DE.AE)","Category Description":" Anomalies, indicators of compromise, and other potentially adverse events are analyzed to characterize the events and detect cybersecurity incidents","Subcategory":"DE.AE-03","Subcategory Description":" Information is correlated from multiple sources","Implementation Examples":"Ex3","Example Description":" Utilize cyber threat intelligence to help correlate events among log sources","Informative References":"CCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: SEF-05\nCRI Profile v2.0: DE.AE-03\nCRI Profile v2.0: DE.AE-03.01\nCRI Profile v2.0: DE.AE-03.02\nCSF v1.1: DE.AE-3\nSP 800-53 Rev 5.1.1: AU-06\nSP 800-53 Rev 5.1.1: CA-07\nSP 800-53 Rev 5.1.1: PM-16\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: IR-05\nSP 800-53 Rev 5.1.1: IR-08\nSP 800-53 Rev 5.1.1: SI-04","Exportable From SIEM":"Yes","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"This query involves an alert with an known malicious IP address.  Research will need to be performed to determine whether the IOC information provides the appropriate metadata to demonstrate that the IOC was correlated with a threat intelligence source.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Adverse Event Analysis (DE.AE)","Category Description":" Anomalies, indicators of compromise, and other potentially adverse events are analyzed to characterize the events and detect cybersecurity incidents","Subcategory":"DE.AE-06","Subcategory Description":" Information on adverse events is provided to authorized staff and tools","Implementation Examples":"Ex1","Example Description":" Use cybersecurity software to generate alerts and provide them to the security operations center (SOC), incident responders, and incident response tools","Informative References":"CCMv4.0: CCC-07\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-13\nCCMv4.0: SEF-05\nCCMv4.0: SEF-06\nCRI Profile v2.0: DE.AE-06\nCRI Profile v2.0: DE.AE-06.01\nCSF v1.1: DE.DP-4\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: PM-15\nSP 800-53 Rev 5.1.1: PM-16\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-10","Exportable From SIEM":"Yes","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"The alerts that are genereated for DE.AE-02 Ex 1 sufficiently demonstrate reporting from log analysis tool","Linked Query":false,"Vendor":null,"Query Version":"DE.AE-02 Ex1","Dashboard Name":null,"Pretty Print Queries":0,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Adverse Event Analysis (DE.AE)","Category Description":" Anomalies, indicators of compromise, and other potentially adverse events are analyzed to characterize the events and detect cybersecurity incidents","Subcategory":"DE.AE-06","Subcategory Description":" Information on adverse events is provided to authorized staff and tools","Implementation Examples":"Ex2","Example Description":" Incident responders and other authorized personnel can access log analysis findings at all times","Informative References":"CCMv4.0: CCC-07\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-13\nCCMv4.0: SEF-05\nCCMv4.0: SEF-06\nCRI Profile v2.0: DE.AE-06\nCRI Profile v2.0: DE.AE-06.01\nCSF v1.1: DE.DP-4\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: PM-15\nSP 800-53 Rev 5.1.1: PM-16\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-10","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This type of evidence would likely need to be fulfilled by showing a service level agreement or some other compliance agreement for the SIEM\/log tool in question.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Adverse Event Analysis (DE.AE)","Category Description":" Anomalies, indicators of compromise, and other potentially adverse events are analyzed to characterize the events and detect cybersecurity incidents","Subcategory":"DE.AE-06","Subcategory Description":" Information on adverse events is provided to authorized staff and tools","Implementation Examples":"Ex3","Example Description":" Automatically create and assign tickets in the organization's ticketing system when certain types of alerts occur","Informative References":"CCMv4.0: CCC-07\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-13\nCCMv4.0: SEF-05\nCCMv4.0: SEF-06\nCRI Profile v2.0: DE.AE-06\nCRI Profile v2.0: DE.AE-06.01\nCSF v1.1: DE.DP-4\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: PM-15\nSP 800-53 Rev 5.1.1: PM-16\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-10","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"Some SIEMs have the ability to integrate directly with a ticketing system.  However, each is done in a manner speciifc to the SIEM and tickeing system.  In many cases, this action is left to a SOAR (Security Orchestration and Automated Response) technology.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"DETECT (DE): Possible cybersecurity attacks and compromises are found and analyzed","Category":"Adverse Event Analysis (DE.AE)","Category Description":" Anomalies, indicators of compromise, and other potentially adverse events are analyzed to characterize the events and detect cybersecurity incidents","Subcategory":"DE.AE-06","Subcategory Description":" Information on adverse events is provided to authorized staff and tools","Implementation Examples":"Ex4","Example Description":" Manually create and assign tickets in the organization's ticketing system when technical staff discover indicators of compromise","Informative References":"CCMv4.0: CCC-07\nCCMv4.0: LOG-03\nCCMv4.0: LOG-05\nCCMv4.0: LOG-13\nCCMv4.0: SEF-05\nCCMv4.0: SEF-06\nCRI Profile v2.0: DE.AE-06\nCRI Profile v2.0: DE.AE-06.01\nCSF v1.1: DE.DP-4\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: PM-15\nSP 800-53 Rev 5.1.1: PM-16\nSP 800-53 Rev 5.1.1: RA-03\nSP 800-53 Rev 5.1.1: RA-10","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This evidence would need to be collected manually from the ticketing system.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Management (RS.MA)","Category Description":" Responses to detected cybersecurity incidents are managed","Subcategory":"RS.MA-01","Subcategory Description":" The incident response plan is executed in coordination with relevant third parties once an incident is declared","Implementation Examples":"Ex1","Example Description":" Detection technologies automatically report confirmed incidents","Informative References":"CCMv4.0: BCR-07\nCCMv4.0: IVS-09\nCCMv4.0: SEF-01\nCCMv4.0: SEF-03\nCCMv4.0: SEF-07\nCIS Controls v8.0: 17.4\nCRI Profile v2.0: RS.MA-01\nCRI Profile v2.0: RS.MA-01.01\nCSF v1.1: RS.RP-1\nCSF v1.1: RS.CO-4\nSP 800-53 Rev 5.1.1: IR-06\nSP 800-53 Rev 5.1.1: IR-07\nSP 800-53 Rev 5.1.1: IR-08\nSP 800-53 Rev 5.1.1: SR-03\nSP 800-53 Rev 5.1.1: SR-08","Exportable From SIEM":"Yes","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"Any security technology will report on incidents that it believes are \"confirmed incidents.\"  However, without human intervention, often it cannot be proven that the incident is confirmed.  Instead, the evidence that can be gathered will be incidents that the SIEM\/security technology believes are confirmed.  In this case, any alert should satisfy this Example.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Management (RS.MA)","Category Description":" Responses to detected cybersecurity incidents are managed","Subcategory":"RS.MA-01","Subcategory Description":" The incident response plan is executed in coordination with relevant third parties once an incident is declared","Implementation Examples":"Ex2","Example Description":" Request incident response assistance from the organization's incident response outsourcer","Informative References":"CCMv4.0: BCR-07\nCCMv4.0: IVS-09\nCCMv4.0: SEF-01\nCCMv4.0: SEF-03\nCCMv4.0: SEF-07\nCIS Controls v8.0: 17.4\nCRI Profile v2.0: RS.MA-01\nCRI Profile v2.0: RS.MA-01.01\nCSF v1.1: RS.RP-1\nCSF v1.1: RS.CO-4\nSP 800-53 Rev 5.1.1: IR-06\nSP 800-53 Rev 5.1.1: IR-07\nSP 800-53 Rev 5.1.1: IR-08\nSP 800-53 Rev 5.1.1: SR-03\nSP 800-53 Rev 5.1.1: SR-08","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This type of evidence would need to be collected manually via email, SOAR case, phone log, or other mechanism to prove that the outsourcer was contacted.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Management (RS.MA)","Category Description":" Responses to detected cybersecurity incidents are managed","Subcategory":"RS.MA-01","Subcategory Description":" The incident response plan is executed in coordination with relevant third parties once an incident is declared","Implementation Examples":"Ex3","Example Description":" Designate an incident lead for each incident","Informative References":"CCMv4.0: BCR-07\nCCMv4.0: IVS-09\nCCMv4.0: SEF-01\nCCMv4.0: SEF-03\nCCMv4.0: SEF-07\nCIS Controls v8.0: 17.4\nCRI Profile v2.0: RS.MA-01\nCRI Profile v2.0: RS.MA-01.01\nCSF v1.1: RS.RP-1\nCSF v1.1: RS.CO-4\nSP 800-53 Rev 5.1.1: IR-06\nSP 800-53 Rev 5.1.1: IR-07\nSP 800-53 Rev 5.1.1: IR-08\nSP 800-53 Rev 5.1.1: SR-03\nSP 800-53 Rev 5.1.1: SR-08","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be dictated by policies and procedures, and would need to be performed at the time of incident.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Management (RS.MA)","Category Description":" Responses to detected cybersecurity incidents are managed","Subcategory":"RS.MA-01","Subcategory Description":" The incident response plan is executed in coordination with relevant third parties once an incident is declared","Implementation Examples":"Ex4","Example Description":" Initiate execution of additional cybersecurity plans as needed to support incident response (for example, business continuity and disaster recovery)","Informative References":"CCMv4.0: BCR-07\nCCMv4.0: IVS-09\nCCMv4.0: SEF-01\nCCMv4.0: SEF-03\nCCMv4.0: SEF-07\nCIS Controls v8.0: 17.4\nCRI Profile v2.0: RS.MA-01\nCRI Profile v2.0: RS.MA-01.01\nCSF v1.1: RS.RP-1\nCSF v1.1: RS.CO-4\nSP 800-53 Rev 5.1.1: IR-06\nSP 800-53 Rev 5.1.1: IR-07\nSP 800-53 Rev 5.1.1: IR-08\nSP 800-53 Rev 5.1.1: SR-03\nSP 800-53 Rev 5.1.1: SR-08","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be dictated by policies and procedures, and would need to be performed at the time of incident.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Management (RS.MA)","Category Description":" Responses to detected cybersecurity incidents are managed","Subcategory":"RS.MA-02","Subcategory Description":" Incident reports are triaged and validated","Implementation Examples":"Ex1","Example Description":" Preliminarily review incident reports to confirm that they are cybersecurity-related and necessitate incident response activities","Informative References":"CCMv4.0: SEF-06\nCRI Profile v2.0: RS.MA-02\nCRI Profile v2.0: RS.MA-02.01\nCSF v1.1: RS.AN-1\nCSF v1.1: RS.AN-2\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: IR-05\nSP 800-53 Rev 5.1.1: IR-06","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be dictated by policies and procedures, and would need to be performed at the time of incident.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Management (RS.MA)","Category Description":" Responses to detected cybersecurity incidents are managed","Subcategory":"RS.MA-02","Subcategory Description":" Incident reports are triaged and validated","Implementation Examples":"Ex2","Example Description":" Apply criteria to estimate the severity of an incident","Informative References":"CCMv4.0: SEF-06\nCRI Profile v2.0: RS.MA-02\nCRI Profile v2.0: RS.MA-02.01\nCSF v1.1: RS.AN-1\nCSF v1.1: RS.AN-2\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: IR-05\nSP 800-53 Rev 5.1.1: IR-06","Exportable From SIEM":"Partial","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"This would be dictated by policies and procedures, and would need to be performed at the time of incident.  However, incident evidence in the SIEM would aid by delineating whether incidenct was Low, Medium, High, or Critical.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Management (RS.MA)","Category Description":" Responses to detected cybersecurity incidents are managed","Subcategory":"RS.MA-03","Subcategory Description":" Incidents are categorized and prioritized","Implementation Examples":"Ex1","Example Description":" Further review and categorize incidents based on the type of incident (e.g., data breach, ransomware, DDoS, account compromise)","Informative References":"CCMv4.0: SEF-02\nCCMv4.0: SEF-06\nCRI Profile v2.0: RS.MA-03\nCRI Profile v2.0: RS.MA-03.01\nCSF v1.1: RS.AN-4\nCSF v1.1: RS.AN-2\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: IR-05\nSP 800-53 Rev 5.1.1: IR-06","Exportable From SIEM":"Partial","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"Both the SIEM or security technology as well as human intelligence would be necessary to perform this task.  The SIEM would attempt to properly categorize the incident based on the correlated evidence.  Human intelligence would be necessary to ultimatley verify and categorize the incident correctly.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Management (RS.MA)","Category Description":" Responses to detected cybersecurity incidents are managed","Subcategory":"RS.MA-03","Subcategory Description":" Incidents are categorized and prioritized","Implementation Examples":"Ex2","Example Description":" Prioritize incidents based on their scope, likely impact, and time-critical nature","Informative References":"CCMv4.0: SEF-02\nCCMv4.0: SEF-06\nCRI Profile v2.0: RS.MA-03\nCRI Profile v2.0: RS.MA-03.01\nCSF v1.1: RS.AN-4\nCSF v1.1: RS.AN-2\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: IR-05\nSP 800-53 Rev 5.1.1: IR-06","Exportable From SIEM":"Partial","API":"Chronicle API Needs Research","Difficulty":null,"Comments":"Both the SIEM or security technology as well as human intelligence would be necessary to perform this task.  The SIEM would attempt to properly categorize the incident based on the correlated evidence.  Human intelligence would be necessary to ultimatley verify and categorize the incident correctly.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Management (RS.MA)","Category Description":" Responses to detected cybersecurity incidents are managed","Subcategory":"RS.MA-03","Subcategory Description":" Incidents are categorized and prioritized","Implementation Examples":"Ex3","Example Description":" Select incident response strategies for active incidents by balancing the need to quickly recover from an incident with the need to observe the attacker or conduct a more thorough investigation","Informative References":"CCMv4.0: SEF-02\nCCMv4.0: SEF-06\nCRI Profile v2.0: RS.MA-03\nCRI Profile v2.0: RS.MA-03.01\nCSF v1.1: RS.AN-4\nCSF v1.1: RS.AN-2\nSP 800-53 Rev 5.1.1: IR-04\nSP 800-53 Rev 5.1.1: IR-05\nSP 800-53 Rev 5.1.1: IR-06","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This would be dictated by policies and procedures, and would need to be performed at the time of incident.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Mitigation (RS.MI)","Category Description":" Activities are performed to prevent expansion of an event and mitigate its effects","Subcategory":"RS.MI-01","Subcategory Description":" Incidents are contained","Implementation Examples":"Ex1","Example Description":" Cybersecurity technologies (e.g., antivirus software) and cybersecurity features of other technologies (e.g., operating systems, network infrastructure devices) automatically perform containment actions","Informative References":"CCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: IVS-09\nCCMv4.0: SEF-02\nCCMv4.0: UEM-09\nCRI Profile v2.0: RS.MI-01\nCRI Profile v2.0: RS.MI-01.01\nCSF v1.1: RS.MI-1\nSP 800-53 Rev 5.1.1: IR-04","Exportable From SIEM":"Yes","API":"UDM Search with YL2","Difficulty":"Done","Comments":"Logs from the cybersecurity technology will typically describe the action that was taken in response to the threat.  In many cases the query would need to be specific to the technology.  However, we'll try to construct a general query for antivirus responses.\n\nNote:  The current version of the query checks for either SentinelOne or Crowdstrike.  However, adding other vendor names is trivial as long they are known (they can be added to the regex filter for $e.metadata.vendor_name.","Linked Query":false,"Vendor":"Agnostic","Query Version":1,"Dashboard Name":null,"Pretty Print Queries":"$hostname = $e.principal.hostname\n$hostname = \/.*\/\n$hostname != \"\"\n\n$e.metadata.vendor_name = \/SentinelOne|Crowdstrike\/ nocase\n($e.security_result.action = \"BLOCK\" OR\n    $e.security_result.action = \"QUARANTINE\" OR\n    $e.security_result.action = \"ALLOW_WITH_MODIFICATION\")\n\n$e.security_result.action != \"UNKNOWN_ACTION\"\n\nmatch:\n    $hostname\n\noutcome:\n    $vendor_name = array_distinct($e.metadata.vendor_name)\n    $security_action = array_distinct($e.security_result.action)\n    $categories = array_distinct($e.security_result.category)\n    $occurences = count($e.metadata.id)\n\norder:\n    $occurences desc\n\nlimit: 25","API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Mitigation (RS.MI)","Category Description":" Activities are performed to prevent expansion of an event and mitigate its effects","Subcategory":"RS.MI-01","Subcategory Description":" Incidents are contained","Implementation Examples":"Ex2","Example Description":" Allow incident responders to manually select and perform containment actions","Informative References":"CCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: IVS-09\nCCMv4.0: SEF-02\nCCMv4.0: UEM-09\nCRI Profile v2.0: RS.MI-01\nCRI Profile v2.0: RS.MI-01.01\nCSF v1.1: RS.MI-1\nSP 800-53 Rev 5.1.1: IR-04","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This SIEM is not directly performing the security response action.  This evidence would need to be gathered manually by demonstrating that the security technology has the ability to accept and execute manual intervention.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Mitigation (RS.MI)","Category Description":" Activities are performed to prevent expansion of an event and mitigate its effects","Subcategory":"RS.MI-01","Subcategory Description":" Incidents are contained","Implementation Examples":"Ex3","Example Description":" Allow a third party (e.g., internet service provider, managed security service provider) to perform containment actions on behalf of the organization","Informative References":"CCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: IVS-09\nCCMv4.0: SEF-02\nCCMv4.0: UEM-09\nCRI Profile v2.0: RS.MI-01\nCRI Profile v2.0: RS.MI-01.01\nCSF v1.1: RS.MI-1\nSP 800-53 Rev 5.1.1: IR-04","Exportable From SIEM":"No","API":null,"Difficulty":null,"Comments":"This type of evidence would be demonstrated by examining the contract which states which actions the third party may perform.  Additional, evidence should be collected where it has been demonstrated that the third party has actually performed said actions at the very least in testing in the organization's environment.","Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":"RESPOND (RS): Actions regarding a detected cybersecurity incident are taken","Category":"Incident Mitigation (RS.MI)","Category Description":" Activities are performed to prevent expansion of an event and mitigate its effects","Subcategory":"RS.MI-01","Subcategory Description":" Incidents are contained","Implementation Examples":"Ex4","Example Description":" Automatically transfer compromised endpoints to a remediation virtual local area network (VLAN)","Informative References":"CCMv4.0: CEK-19\nCCMv4.0: CEK-20\nCCMv4.0: IVS-09\nCCMv4.0: SEF-02\nCCMv4.0: UEM-09\nCRI Profile v2.0: RS.MI-01\nCRI Profile v2.0: RS.MI-01.01\nCSF v1.1: RS.MI-1\nSP 800-53 Rev 5.1.1: IR-04","Exportable From SIEM":"Partial","API":"UDM Search with YL2","Difficulty":"Custom","Comments":"This would be a response action perform by a switch, firewall, wireless access point, et cetera and would not be the function of the SIEM.  However, the logs of the response would likely be sent to the SIEM.  So, a custom query specific to the manufacturer should be able to be created to use as evidence.","Linked Query":false,"Vendor":"CustomRequired","Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":null,"Category":null,"Category Description":null,"Subcategory":null,"Subcategory Description":null,"Implementation Examples":null,"Example Description":null,"Informative References":null,"Exportable From SIEM":"Select","API":null,"Difficulty":null,"Comments":null,"Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null},{"Function":null,"Category":null,"Category Description":null,"Subcategory":null,"Subcategory Description":null,"Implementation Examples":null,"Example Description":null,"Informative References":null,"Exportable From SIEM":"Select","API":null,"Difficulty":null,"Comments":null,"Linked Query":false,"Vendor":null,"Query Version":null,"Dashboard Name":null,"Pretty Print Queries":null,"API Queries":null}]